{"version":3,"sources":["styles/icons/star_default.svg","styles/icons/star_empty.svg","components/star/index.tsx","components/level-select-top-bar/index.tsx","services/constants.ts","services/context.ts","components/tile/index.tsx","classes/grid-cell.tsx","classes/grid.ts","components/level-select-grid/index.tsx","classes/item.ts","components/swatch/index.tsx","services/levels.ts","classes/swatch.tsx","services/_levels/swatches-1.tsx","services/_levels/swatches-2.tsx","services/_levels/swatches-3.tsx","services/_levels/tricolor.tsx","services/_levels/up-the-middle.ts","services/_levels/keys.ts","services/_levels/dark-tiles-1.tsx","services/_levels/dark-tiles-2.ts","services/_levels/dark-swatch.tsx","services/_levels/ice-1.tsx","services/_levels/ice-2.tsx","components/level-preview/index.tsx","components/level-select-buttons/index.tsx","components/level-select-mobile/index.tsx","components/level-select/index.tsx","components/player/index.tsx","services/hooks.ts","services/util.ts","components/grid/index.tsx","components/game-menu/index.tsx","components/game-top-bar/index.tsx","components/game-hud/index.tsx","components/game-complete/index.tsx","components/solution-player-cursor/index.tsx","components/solution-adjust-menu/index.tsx","components/solution/index.tsx","components/game-adjust-menu/index.tsx","components/settings/index.tsx","components/instructions/index.tsx","components/game-tutorial/index.tsx","classes/player.ts","classes/game-history.ts","classes/grid-animation-frame.ts","classes/player-animation-frame.ts","classes/tile-animation-frame.ts","components/game/index.tsx","components/game-redirect/index.tsx","components/home/index.tsx","services/cc-util.ts","services/idb.ts","components/app/index.tsx","index.tsx"],"names":["_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgStarDefault","_ref","svgRef","title","titleId","props","width","height","viewBox","xmlns","ref","id","transform","d","fill","stroke","strokeWidth","style","paintOrder","ForwardRef","SvgStarEmpty","Star","size","className","filled","LevelSelectTopBar","starText","starCount","to","icon","faArrowLeft","Color","AnimationType","Direction","PlayerMovementType","DEFAULT_SOLUTION_CONTAINER_SIZE","TILES_SIZES","DIR_OFFSET","UP","rowOffset","colOffset","DOWN","LEFT","RIGHT","GridOffsetContext","React","createContext","x","y","TileSizeContext","Tile","row","col","pRow","pCol","offset","useContext","tileSize","color","DEFAULT","colorClass","alt","solutionColor","solution","solutionClass","solutionStyle","opacity","showSolution","tileStyle","left","top","hoverTile","playerRow","playerCol","undefined","onTilePress","hoverClass","hoverStyle","borderWidth","Math","ceil","onClick","iceTile","ice","tileBackStyle","borderRadius","GridCell","item","immerable","playerColor","DARK","elements","push","render","Grid","config","cells","map","rowIdx","cell","colIdx","hasTile","tileColor","cloneDeep","max","j","gridCell","renderElements","renderSolution","windowWidth","windowHeight","LevelSelectGrid","useResizeDetector","refreshMode","refreshRate","grid","getCenterOffset","gridTiles","Provider","value","Item","SwatchComponent","useState","random","animationDelay","SWATCH_SIZE","floor","QUARTER_DIFF","swatchStyle","borderStyle","InstructionHighlightType","Swatch","LEVEL_SWATCHES_1","description","levelInstructions","element","gridConfig","RED","BLUE","levelName","starRequirement3","starRequirement2","requiredToUnlock","LEVEL_SWATCHES_2","PURPLE","ORANGE","LEVEL_SWATCHES_3","GREEN","YELLOW","TRICOLOR","UP_THE_MIDDLE","KEYS","DARK_TILES_1","DARK_TILES_2","DARK_SWATCH","ICE_1","ICE_2","LEVELS","STAR_SIZE","getLevelScoringTable","level","getPersonalBestTable","starsScored","moves","pbStars","pbMoves","LevelPreview","selectedLevel","starsScoredOnLevel","toNextLevel","starsToUnlockLevel","faLock","faPlay","levelScoreMap","LevelSelectButtons","toggleSelected","levelNum","setIsSelected","isSelected","setSelectedLevel","buttons","idx","btnClass","bind","containerRef","LevelSelectMobile","levelPreview","LevelSelect","btnContainerRef","useRef","mainClassName","event","preventDefault","current","PlayerComponent","movementToggle","rowPosition","setRowPosition","colPosition","setColPosition","prevProps","useEffect","usePrevious","PLAYER_SIZE","frameCount","easeFn","easeQuadInOut","animationFrames","playerMovementType","TO_ICE","easeQuadIn","FROM_ICE","easeQuadOut","ON_ICE","easeLinear","interval","setInterval","clearInterval","onAnimationEnd","increment","playerStyle","playerBodyStyle","sleep","ms","Promise","resolve","setTimeout","getBoundValue","val","upperBound","lowerBound","min","GridComponent","isPointerDown","setIsPointerDown","isDragging","setIsDragging","distanceDragged","setDistanceDragged","lastPointerX","setLastPointerX","lastPointerY","setLastPointerY","offsetPctX","setOffsetPctX","offsetPctY","setOffsetPctY","hasInitialOffset","setHasInitialOffset","setInitialOffset","onGridSizeChange","levelNumber","shouldResetLayout","gridElements","isPlayerMoving","onPointerUp","a","wasDragging","releasePointerCapture","pointerId","dragHandler","gridContainerProps","onPointerDown","clientX","clientY","onPointerMove","distX","abs","distY","totalDist","setPointerCapture","nextOffsetPctX","nextOffsetPctY","onPlayerAnimationEnd","GameMenu","openClass","isOpen","overlayClass","navClass","tabIndex","tutorialBtn","showSettings","faCog","startTutorial","setOpen","faInfoCircle","faThLarge","showInstructions","faQuestionCircle","resetLayout","faSync","GameTopBar","toggled","isMenuOpen","onToggle","setMenuOpen","rounded","label","hideOutline","movesTaken","GameHUD","GameComplete","nextBtn","nextUnlockElement","stars","restartHandler","SolutionPlayerCursor","cursorStyle","cornerStyle","SolutionAdjustMenu","zoomInClass","canZoomIn","zoomOutClass","canZoomOut","zoomInHandler","faSearchPlus","zoomOutHandler","faSearchMinus","MIN_CONTAINER_SIZE","getBoundedContainerOffsetPctX","offsetPct","solutionWidth","gridWidth","minOffset","getBoundedContainerOffsetPctY","solutionHeight","gridHeight","TOP_MENU_HEIGHT","getContainerOffsetX","getContainerOffsetY","DEFAULT_CONTAINER_OFFSET","getProperContainerSize","maxContainerWidth","maxContainerHeight","Solution","tileSizeIndex","setTileSizeIndex","containerWidth","setContainerWidth","containerHeight","setContainerHeight","mobileHeightPct","setMobileHeightPct","isGridPointerDown","setIsGridPointerDown","gridOffsetPctX","setGridOffsetPctX","gridOffsetPctY","setGridOffsetPctY","isContainerPointerDown","setIsContainerPointerDown","containerOffsetPctX","setContainerOffsetPctX","containerOffsetPctY","setContainerOffsetPctY","solutionTopRef","isInMobileView","onResetLayout","appHeight","pct","onGridPointerUp","onContainerPointerUp","canAdjust","gameOver","solutionProps","node","parentElement","isInElementById","topBarClassName","topBarProps","containerStyle","mHeight","right","solutionTiles","solutionElement","maxSize","axis","onResize","data","minConstraints","maxConstraints","Infinity","resizeHandles","newWidth","newHeight","GameAdjustMenu","undoClass","canUndo","redoClass","canRedo","undoHandler","faUndoAlt","redoHandler","faRedoAlt","Settings","showEraseConfirm","setShowEraseConfirm","visible","eraseElement","onEraseData","eraseConfirm","onGoBack","Instructions","GameTutorial","currentInstruction","setCurrentInstruction","onComplete","child","canGoPrevious","canSkip","prevBtn","skipBtn","nextText","Player","movement","directionMoved","currCell","getCellAt","currentDirection","prevDirection","nextRow","nextCol","nextPlayerColor","updatePlayerColor","moveType","moved","newRow","newCol","newColor","gridCellMovedTo","movementType","GameHistoryNode","previous","next","GameHistoryDoublyLinkedList","start","end","_size","GameHistory","undoHistory","redoHistory","currentState","clear","shift","undoNode","pop","redoNode","GridAnimationFrame","animationType","isStart","PLAYER","TILE","PlayerAnimationFrame","TileAnimationFrame","Game","movementKeyFnMap","utilKeyFnMap","keyPressFlagMap","gridAnimationQueue","gameContainerRef","gameHistory","state","gameStarted","gameWon","starsWon","areSettingsOpened","areInstructionsOpened","shouldCancelTilePress","showTutorial","completedBefore","Queue","createRef","onKeyDown","onKeyUp","resetFlags","restartGame","inGameRestart","undo","redo","zoomIn","zoomOut","hideOtherWindows","setShouldCancelTilePress","onCompleteTutorial","ArrowUp","movePlayerByKeyDown","ArrowDown","ArrowLeft","ArrowRight","r","z","handleMenuKeyDown","toLowerCase","setState","activeEle","document","activeElement","isActiveOnHam","classList","contains","isActiveOnLink","isActiveOnFirst","isActiveOnLast","hamBtn","querySelector","focus","firstBtn","sibling","nextSibling","previousSibling","lastBtn","player","playerMovement","moveResult","move","moveCount","count","updatedTileColor","updateColor","enqueue","dir","movedPrevLoop","isGameActive","isAnimationInProgress","gridClone","makeMove","startNextAnimation","pressDir","numTimesToMove","timesMoved","shouldStopMoving","animationFrame","dequeue","isPlayerAnimation","produce","draft","isGridSolved","handleStarUpdate","newGrid","canAlterGameState","gameHistoryState","bool","gameClass","gameStyle","display","gameCompleteEle","tutorial","onFocus","onBlur","Component","GameRedirect","useParams","levelInt","parseInt","isNaN","solved","TITLE","Home","gradientDelay","playAnimation","setPlayAnimation","setShowSettings","setShowInstructions","playLevelNumber","setPlayLevelNumber","onReturn","homeClass","coloredTitles","bgLayers","titleClass","layerClass","gradientStyle","homeStyle","lastUnlockedLevel","firstUnsolvedLevel","firstIncompleteLevel","getDefaultLevelScoreMap","getStarsScoredByMoves","starReq3","starReq2","DB_NAME","SCORES_STORE_NAME","upgrade","db","createObjectStore","keyPath","openDB","transaction","scoresStore","objectStore","getAll","scores","done","close","levelById","levelConfig","score","levelId","get","prevScore","put","App","setStarCount","playHomeAnimation","setPlayHomeAnimation","isReady","setIsReady","areFontsLoaded","setAreFontsLoaded","isSavedDataLoaded","setIsSavedDataLoaded","setLevelScoreMap","loaderBarFill","getLoaderBarFill","add","onFontsLoad","WebFont","load","custom","families","timeout","active","inactive","loadLevelScores","then","mapping","totalStars","catch","toast","error","numFinished","loadingTextElement","getElementById","textContent","remove","loaderElement","onFinish","path","prevStars","nextLevelScoreMap","saveScore","clearScores","success","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.6c1612ff.chunk.js","sourcesContent":["var _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgStarDefault(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 31.031,\n    height: 29.924,\n    viewBox: \"0 0 31.031214 29.924433\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(-14.022 -18.173)\",\n    \"data-name\": \"Layer 21\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m43.075 32.997a3.38 3.38 0 0 0 -1.87 -5.75l-5.25-0.79a1.42 1.42 0 0 1 -1 -0.75l-2.42-4.74a3.37 3.37 0 0 0 -6 0l-2.39 4.74a1.42 1.42 0 0 1 -1 0.75l-5.25 0.79a3.38 3.38 0 0 0 -1.9 5.75l3.78 3.72a1.4 1.4 0 0 1 0.4 1.21l-0.87 5.23a3.35 3.35 0 0 0 1.34 3.29 3.4 3.4 0 0 0 2 0.65 3.37 3.37 0 0 0 1.56 -0.39l4.7-2.44a1.38 1.38 0 0 1 1.28 0l4.7 2.44a3.37 3.37 0 0 0 4.89 -3.55l-0.87-5.23a1.4 1.4 0 0 1 0.4 -1.21z\",\n    fill: \"#f7c761\",\n    stroke: \"#704728\",\n    strokeWidth: 2,\n    style: {\n      paintOrder: \"normal\"\n    }\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgStarDefault);\nexport default __webpack_public_path__ + \"static/media/star_default.50ce398f.svg\";\nexport { ForwardRef as ReactComponent };","var _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgStarEmpty(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 31.031,\n    height: 29.924,\n    viewBox: \"0 0 31.031214 29.924433\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    transform: \"translate(-14.022 -18.173)\",\n    \"data-name\": \"Layer 21\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m43.075 32.997a3.38 3.38 0 0 0 -1.87 -5.75l-5.25-0.79a1.42 1.42 0 0 1 -1 -0.75l-2.42-4.74a3.37 3.37 0 0 0 -6 0l-2.39 4.74a1.42 1.42 0 0 1 -1 0.75l-5.25 0.79a3.38 3.38 0 0 0 -1.9 5.75l3.78 3.72a1.4 1.4 0 0 1 0.4 1.21l-0.87 5.23a3.35 3.35 0 0 0 1.34 3.29 3.4 3.4 0 0 0 2 0.65 3.37 3.37 0 0 0 1.56 -0.39l4.7-2.44a1.38 1.38 0 0 1 1.28 0l4.7 2.44a3.37 3.37 0 0 0 4.89 -3.55l-0.87-5.23a1.4 1.4 0 0 1 0.4 -1.21z\",\n    fill: \"#333\",\n    stroke: \"#704728\",\n    strokeWidth: 2,\n    style: {\n      paintOrder: \"normal\"\n    }\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgStarEmpty);\nexport default __webpack_public_path__ + \"static/media/star_empty.a9d1e6f6.svg\";\nexport { ForwardRef as ReactComponent };","import { ReactComponent as StarSvg } from \"../../styles/icons/star_default.svg\";\r\nimport { ReactComponent as EmptyStarSvg } from \"../../styles/icons/star_empty.svg\";\r\n\r\ninterface StarProps {\r\n    filled: boolean,\r\n    className?: string,\r\n    size?: number\r\n};\r\n\r\nexport default function Star(props: StarProps) {\r\n    const style = props.size ? { height: `${props.size}px`, width: `${props.size}px` } : {};\r\n    const className = props.className ?? \"\";\r\n\r\n    if (props.filled) {\r\n        return (<StarSvg className={className} style={style} />);\r\n    }\r\n\r\n    return (<EmptyStarSvg className={className} style={style} />);\r\n}\r\n","import { Link } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\r\nimport Star from \"../star\";\r\nimport \"./level-select-top-bar.scss\";\r\n\r\ninterface LevelSelectTopBarProps {\r\n    starCount: number\r\n};\r\n\r\nexport default function LevelSelectTopBar(props: LevelSelectTopBarProps) {\r\n    const starText = `\\u00d7 ${props.starCount}`;\r\n\r\n    return (\r\n        <header className=\"top-bar level-select-top-bar\">\r\n            <Link to=\"/\" className=\"top-bar-text back-btn\" aria-label=\"Go back\">\r\n                <FontAwesomeIcon icon={faArrowLeft} />\r\n            </Link>\r\n            <div className=\"level-select-title\">\r\n                <h1 className=\"top-bar-text\">Level Select</h1>\r\n            </div>\r\n            <div className=\"level-select-stars\">\r\n                <span className=\"top-bar-text\">\r\n                    <Star filled size={24} />\r\n                    {starText}\r\n                </span>\r\n            </div>\r\n            <div className=\"clearfix\"></div>\r\n        </header>\r\n    );\r\n}\r\n","export const DEFAULT_TILE_SIZE = 48;\r\nexport const DEFAULT_SOLUTION_TILE_SIZE = 20;\r\nexport const DEFAULT_SOLUTION_CONTAINER_SIZE = 300;\r\nexport const TOP_MENU_HEIGHT = 48;\r\nexport const GAME_MOBILE_WIDTH = 640;\r\n\r\nexport const TILES_SIZES = [ 12, 16, 20, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96 ];\r\n\r\nexport enum Color {\r\n    BLUE = \"blue\",\r\n    DARK = \"dark\",\r\n    DEFAULT = \"default\",\r\n    GREEN = \"green\",\r\n    ORANGE = \"orange\",\r\n    PURPLE = \"purple\",\r\n    RED = \"red\",\r\n    YELLOW = \"yellow\"\r\n};\r\n\r\nexport enum AnimationType {\r\n    PLAYER = \"player\",\r\n    TILE = \"tile\"\r\n};\r\n\r\nexport enum Direction {\r\n    UP = \"up\",\r\n    DOWN = \"down\",\r\n    LEFT = \"left\",\r\n    RIGHT = \"right\"\r\n};\r\n\r\nexport enum PlayerMovementType {\r\n    DEFAULT = \"default\",\r\n    TO_ICE = \"to-ice\",\r\n    FROM_ICE = \"from-ice\",\r\n    ON_ICE = \"on-ice\"\r\n};\r\n\r\ninterface DirectionOffset {\r\n    rowOffset: number,\r\n    colOffset: number\r\n};\r\n\r\nexport const DIR_OFFSET: Record<Direction, DirectionOffset> = {\r\n    [Direction.UP]: { rowOffset: -1, colOffset: 0 },\r\n    [Direction.DOWN]: { rowOffset: 1, colOffset: 0 },\r\n    [Direction.LEFT]: { rowOffset: 0, colOffset: -1 },\r\n    [Direction.RIGHT]: { rowOffset: 0, colOffset: 1 }\r\n};\r\n","import React from \"react\";\r\nimport { DEFAULT_TILE_SIZE } from \"../services/constants\";\r\n\r\ninterface GridOffset {\r\n    x: number,\r\n    y: number\r\n};\r\n\r\nexport type { GridOffset };\r\n\r\nexport const GridOffsetContext: React.Context<GridOffset> = React.createContext({ x: 0, y: 0 });\r\n\r\nexport const TileSizeContext = React.createContext(DEFAULT_TILE_SIZE);\r\n","import { useContext } from \"react\";\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport { Color } from \"../../services/constants\";\r\nimport \"./tile.scss\";\r\n\r\ninterface TileProps {\r\n    row: number,\r\n    col: number,\r\n    color?: Color,\r\n    ice?: boolean,\r\n    solution?: Color,\r\n    alt?: boolean,\r\n    showSolution?: boolean,\r\n    playerRow?: number,\r\n    playerCol?: number,\r\n    onTilePress?: (row: number, col: number) => void\r\n}\r\n\r\nfunction isSameRowOrColumn(row: number, col: number, pRow?: number, pCol?: number): boolean {\r\n    if (pRow === undefined || pCol === undefined) {\r\n        return false;\r\n    }\r\n\r\n    // Returns true if cell is in the same column or row as the player, but not in the exact\r\n    // same position as the player\r\n    return (row === pRow && col !== pCol) || (row !== pRow && col === pCol);\r\n}\r\n\r\nexport default function Tile(props: TileProps) {\r\n    const offset = useContext(GridOffsetContext);\r\n    const tileSize = useContext(TileSizeContext);\r\n    const color = props.color ?? Color.DEFAULT;\r\n    let colorClass = `tile-front bg-${color} ${props.alt ? \"alt\" : \"\"}`;\r\n\r\n    const solutionColor = props.solution ?? Color.DEFAULT;\r\n    const solutionClass = `tile-solution bg-${solutionColor} ${props.alt ? \"alt\" : \"\"}`;\r\n    const solutionStyle = { opacity: props.showSolution ? \"1\" : \"0\" };\r\n\r\n    const tileStyle = {\r\n        height: `${tileSize}px`,\r\n        left: `${(props.col * tileSize) + offset.x}px`,\r\n        top: `${(props.row * tileSize) + offset.y}px`,\r\n        width: `${tileSize}px`\r\n    };\r\n\r\n    // Hover tile, if the user hovers over a tile in the same row or column as the player\r\n    let hoverTile = null;\r\n    if (isSameRowOrColumn(props.row, props.col, props.playerRow, props.playerCol) &&\r\n        props.onTilePress) {\r\n\r\n        const hoverClass = `tile-hover hover-${color}`;\r\n        const onTileClick = () => {\r\n            props.onTilePress && props.onTilePress(props.row, props.col);\r\n        }\r\n\r\n        const hoverStyle = {\r\n            borderWidth: `${Math.ceil(tileSize / 12)}px`\r\n        };\r\n\r\n        hoverTile = <div className={hoverClass} onClick={onTileClick} style={hoverStyle}></div>;\r\n    }\r\n\r\n    // Ice layer\r\n    let iceTile = props.ice ? (\r\n        <div className=\"tile-ice\"></div>\r\n    ) : null;\r\n\r\n    const tileBackStyle = {\r\n        borderRadius: `${Math.ceil(tileSize / 12)}px`\r\n    };\r\n\r\n    return (\r\n        <div className=\"tile\" style={tileStyle}>\r\n            {hoverTile}\r\n            {iceTile}\r\n            <div className={solutionClass} style={solutionStyle}></div>\r\n            <div className={colorClass}></div>\r\n            <div className=\"tile-back\" style={tileBackStyle}></div>\r\n        </div>\r\n    );\r\n}\r\n","import { immerable } from \"immer\";\r\nimport { Color } from \"../services/constants\";\r\nimport Tile from \"../components/tile\";\r\nimport type Item from \"./item\";\r\n\r\nexport default class GridCell {\r\n    [ immerable ] = true;\r\n    row: number;\r\n    col: number;\r\n    color: Color;\r\n    solutionColor: Color;\r\n    item?: Item;\r\n    ice: boolean;\r\n\r\n    constructor(\r\n        row: number,\r\n        col: number, color?:\r\n        Color, solutionColor?:\r\n        Color,\r\n        item?: Item,\r\n        ice?: boolean\r\n    ) {\r\n        this.row = row;\r\n        this.col = col;\r\n        this.color = color ?? Color.DEFAULT;\r\n        this.solutionColor = solutionColor ?? Color.DEFAULT;\r\n        this.item = item;\r\n        this.ice = ice ?? false;\r\n    }\r\n\r\n    updateColor(playerColor: Color): (Color | null) {\r\n\r\n        // Cannot change color of a dark tile\r\n        if (this.color === Color.DARK) {\r\n            return null;\r\n        }\r\n\r\n        // If the player is dark and the tile is colored, erase the tile color\r\n        if (playerColor === Color.DARK && this.color !== Color.DEFAULT) {\r\n            this.color = Color.DEFAULT;\r\n            return this.color;\r\n        }\r\n\r\n        // If the player is colored and the tile is a different color (but not dark),\r\n        // re-color the tile\r\n        if (playerColor !== Color.DEFAULT && playerColor !== Color.DARK &&\r\n            playerColor !== this.color) {\r\n            this.color = playerColor;\r\n            return this.color;\r\n        }\r\n\r\n        // Otherwise, tile stays the same\r\n        return null;\r\n    }\r\n\r\n    renderElements(\r\n        showSolution: boolean,\r\n        playerRow?: number,\r\n        playerCol?: number,\r\n        onTilePress?: (row: number, col: number) => void\r\n    ): JSX.Element[] {\r\n        const key = `tile-${this.row}-${this.col}`;\r\n        const elements = [];\r\n        elements.push(\r\n            <Tile key={key} color={this.color} alt={(this.row + this.col) % 2 === 0}\r\n                solution={this.solutionColor} showSolution={showSolution}\r\n                row={this.row} col={this.col} playerRow={playerRow} playerCol={playerCol}\r\n                ice={this.ice} onTilePress={onTilePress} />\r\n        );\r\n\r\n        if (this.item) {\r\n            elements.push(this.item.render(this.row, this.col));\r\n        }\r\n\r\n        return elements;\r\n    }\r\n\r\n    renderSolution(): JSX.Element {\r\n        const key = `solution-tile-${this.row}-${this.col}`;\r\n        return (\r\n            <Tile key={key} color={this.solutionColor} ice={this.ice}\r\n                alt={(this.row + this.col) % 2 === 0}\r\n                row={this.row} col={this.col} />\r\n        );\r\n    }\r\n}\r\n","import { immerable } from \"immer\";\r\nimport { cloneDeep } from \"lodash\";\r\nimport GridCell from \"./grid-cell\";\r\n\r\nimport type Item from \"./item\";\r\nimport type { Color } from \"../services/constants\";\r\nimport type { GridOffset } from \"../services/context\";\r\n\r\ninterface GridCellConfig {\r\n    hasTile: boolean,\r\n    tileColor?: Color,\r\n    solutionColor?: Color,\r\n    item?: Item,\r\n    ice?: boolean\r\n}\r\n\r\nexport type { GridCellConfig };\r\n\r\nexport default class Grid {\r\n    [ immerable ] = true;\r\n    private cells: (GridCell | null)[][];\r\n    width: number;\r\n    height: number;\r\n\r\n    constructor(config: GridCellConfig[][]) {\r\n        this.cells = config.map((row, rowIdx) => {\r\n            return row.map((cell, colIdx) => {\r\n                return (cell.hasTile) ?\r\n                    new GridCell(\r\n                        rowIdx,\r\n                        colIdx,\r\n                        cell.tileColor,\r\n                        cell.solutionColor,\r\n                        cloneDeep(cell.item),\r\n                        cell.ice\r\n                    ) : null;\r\n            });\r\n        });\r\n\r\n        this.height = this.cells.length;\r\n        this.width = Math.max(...this.cells.map(row => row.length));\r\n    }\r\n\r\n    // Returns GridCell if one exists at the given position\r\n    getCellAt(row: number, col: number): (GridCell | null) {\r\n        if (this.cells[row] && this.cells[row][col]) {\r\n            return this.cells[row][col];\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    isGridSolved(): boolean {\r\n        for (let i = 0; i < this.cells.length; i += 1) {\r\n            for (let j = 0; j < this.cells[i].length; j += 1) {\r\n                const cellColor = this.cells[i][j]?.color ?? null;\r\n                const solutionColor = this.cells[i][j]?.solutionColor ?? null;\r\n\r\n                if (cellColor !== solutionColor) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    renderElements(\r\n        showSolution: boolean,\r\n        playerRow?: number,\r\n        playerCol?: number,\r\n        onTilePress?: (row: number, col: number) => void\r\n    ): JSX.Element[] {\r\n        const elements = [];\r\n\r\n        for (let i = 0; i < this.cells.length; i += 1) {\r\n            for (let j = 0; j < this.cells[i].length; j += 1) {\r\n                const gridCell = this.cells[i][j];\r\n\r\n                if (gridCell) {\r\n                    elements.push(...gridCell.renderElements(\r\n                        showSolution,\r\n                        playerRow,\r\n                        playerCol,\r\n                        onTilePress\r\n                    ));\r\n                }\r\n            }\r\n        }\r\n\r\n        return elements;\r\n    }\r\n\r\n    renderSolution(): JSX.Element[] {\r\n        const elements = [];\r\n\r\n        for (let i = 0; i < this.cells.length; i += 1) {\r\n            for (let j = 0; j < this.cells[i].length; j += 1) {\r\n                const gridCell = this.cells[i][j];\r\n\r\n                if (gridCell) {\r\n                    elements.push(gridCell.renderSolution());\r\n                }\r\n            }\r\n        }\r\n\r\n        return elements;\r\n    }\r\n\r\n    /**\r\n     * Calculates the x and y offset to center the grid in a given window\r\n     * @param tileSize Size of a single tile, in px\r\n     * @param windowWidth Width of the window containing the grid, in px\r\n     * @param windowHeight Height of the window containing the grid, in px\r\n     */\r\n    getCenterOffset(tileSize: number, windowWidth: number, windowHeight: number): GridOffset {\r\n        return {\r\n            x: (windowWidth - (this.width * tileSize)) / 2,\r\n            y: (windowHeight - (this.height * tileSize)) / 2\r\n        };\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport { useResizeDetector } from 'react-resize-detector/build/withPolyfill';\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport { DEFAULT_SOLUTION_TILE_SIZE } from \"../../services/constants\";\r\nimport \"./level-select-grid.scss\";\r\n\r\nimport type Grid from \"../../classes/grid\";\r\n\r\ninterface LevelSelectGridProps {\r\n    grid: Grid\r\n};\r\n\r\nexport default function LevelSelectGrid(props: LevelSelectGridProps) {\r\n    const { width, height, ref } = useResizeDetector({\r\n        refreshMode: \"throttle\",\r\n        refreshRate: 10\r\n    });\r\n\r\n    const offset = props.grid.getCenterOffset(DEFAULT_SOLUTION_TILE_SIZE, width ?? 0, height ?? 0);\r\n    const gridTiles = props.grid.renderSolution();\r\n\r\n    return (\r\n        <GridOffsetContext.Provider value={offset}>\r\n            <TileSizeContext.Provider value={DEFAULT_SOLUTION_TILE_SIZE}>\r\n                <div className=\"level-preview-grid\" ref={ref}>\r\n                    {gridTiles}\r\n                </div>\r\n            </TileSizeContext.Provider>\r\n        </GridOffsetContext.Provider>\r\n    );\r\n}\r\n","import { immerable } from \"immer\";\r\nimport type { Color } from \"../services/constants\";\r\n\r\nexport default abstract class Item {\r\n    [ immerable ] = true;\r\n\r\n    abstract render(row: number, col: number): JSX.Element;\r\n\r\n    // Returns the color the player would change to if they land on the item\r\n    updatePlayerColor(): (Color | null) {\r\n        return null;\r\n    }\r\n}\r\n","import { useContext, useState } from \"react\";\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport \"./swatch.scss\";\r\nimport { Color } from \"../../services/constants\";\r\n\r\ninterface SwatchComponentProps {\r\n    color: Color,\r\n    row: number,\r\n    col: number\r\n}\r\n\r\nexport default function SwatchComponent(props: SwatchComponentProps) {\r\n    const offset = useContext(GridOffsetContext);\r\n    const tileSize = useContext(TileSizeContext);\r\n    const [ animationDelay ] = useState(Math.random() * 4);\r\n\r\n    const SWATCH_SIZE = Math.floor((tileSize * 5) / 12);\r\n    const QUARTER_DIFF = (tileSize - SWATCH_SIZE) / 2;\r\n\r\n    const colorClass = `swatch bg-${props.color}`;\r\n    const swatchStyle = {\r\n        animationDelay: `-${animationDelay}s`,\r\n        height: `${SWATCH_SIZE}px`,\r\n        left: `${(props.col * tileSize) + QUARTER_DIFF + offset.x}px`,\r\n        top: `${(props.row * tileSize) + QUARTER_DIFF + offset.y}px`,\r\n        width: `${SWATCH_SIZE}px`\r\n    };\r\n\r\n    const borderStyle = {\r\n        borderWidth: `${Math.ceil((SWATCH_SIZE * 3) / 20)}px`\r\n    }\r\n\r\n    return (\r\n        <div className={colorClass} style={swatchStyle}>\r\n            <div className=\"swatch-border\" style={borderStyle}></div>\r\n        </div>\r\n    );\r\n}\r\n","import LEVEL_SWATCHES_1 from \"./_levels/swatches-1\";\r\nimport LEVEL_SWATCHES_2 from \"./_levels/swatches-2\";\r\nimport LEVEL_SWATCHES_3 from \"./_levels/swatches-3\";\r\nimport TRICOLOR from \"./_levels/tricolor\";\r\nimport UP_THE_MIDDLE from \"./_levels/up-the-middle\";\r\nimport KEYS from \"./_levels/keys\";\r\nimport DARK_TILES_1 from \"./_levels/dark-tiles-1\";\r\nimport DARK_TILES_2 from \"./_levels/dark-tiles-2\";\r\nimport DARK_SWATCH from \"./_levels/dark-swatch\";\r\nimport ICE_1 from \"./_levels/ice-1\";\r\nimport ICE_2 from \"./_levels/ice-2\";\r\nimport type { GridCellConfig } from \"../classes/grid\";\r\n\r\nexport enum InstructionHighlightType {\r\n    PLAYER = \"player\",\r\n    TILE = \"tile\"\r\n};\r\n\r\ninterface LevelInstruction {\r\n    element: React.ReactElement,\r\n    highlight?: InstructionHighlightType,\r\n    tileRow?: number,\r\n    tileCol?: number\r\n};\r\n\r\ninterface GameConfig {\r\n    id: string,\r\n    levelName: string,\r\n    description?: React.ReactElement,\r\n    levelInstructions?: LevelInstruction[],  // Instructions that show during the level\r\n    gridConfig: GridCellConfig[][],          // Specifies layout of the grid\r\n    playerRow: number,                       // Starting row for the player\r\n    playerCol: number,                       // Starting column for the player\r\n    starRequirement3: number,                // Move requirement to get 3 stars on the level\r\n    starRequirement2: number,                // Move requirement to get 2 stars\r\n    requiredToUnlock: number                 // Number of stars required to unlock the level,\r\n};\r\n\r\nexport type { GameConfig, LevelInstruction };\r\n\r\nconst LEVELS: GameConfig[] = [\r\n    LEVEL_SWATCHES_1,\r\n    LEVEL_SWATCHES_2,\r\n    LEVEL_SWATCHES_3,\r\n    TRICOLOR,\r\n    KEYS,\r\n    UP_THE_MIDDLE,\r\n    DARK_TILES_1,\r\n    DARK_TILES_2,\r\n    DARK_SWATCH,\r\n    ICE_1,\r\n    ICE_2\r\n];\r\n\r\nexport default LEVELS;\r\n","import Item from \"./item\";\r\nimport SwatchComponent from \"../components/swatch\"\r\nimport { Color } from \"../services/constants\";\r\n\r\nexport default class Swatch extends Item {\r\n    color: Color;\r\n\r\n    constructor(color?: Color) {\r\n        super();\r\n        this.color = color ?? Color.DEFAULT;\r\n    }\r\n\r\n    render(row: number, col: number): JSX.Element {\r\n        const key = `swatch-${row}-${col}`;\r\n        return <SwatchComponent color={this.color} row={row} col={col} key={key} />\r\n    }\r\n\r\n    updatePlayerColor(): Color {\r\n        return this.color;\r\n    }\r\n}\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst LEVEL_SWATCHES_1: GameConfig = {\r\n    id: \"X08Cn2VWa0C6YvdCaTQMFw==\",\r\n    description: <p>An introduction to the game of <em>Color Coords</em>.</p>,\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    Welcome to <em>Color Coords</em>! The goal of the game is to color the puzzle\r\n                    grid to match the solution shown in the target window.\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    To do so, start by moving your <strong> player piece </strong>\r\n                    across the grid. You can use either the arrow keys or by clicking on the tile\r\n                    you wish to move to. Note: you can only click on tiles in the same row or column\r\n                    as the player piece.\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    In order to color the grid, you will need to move your player piece onto a\r\n                    <strong> swatch </strong> item. After doing so, your player piece\r\n                    will change color, giving you the ability to paint the grid as you move around.\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    Try to solve the puzzle in the fewest moves possible. Good luck and have fun!\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.BLUE, item: new Swatch(Color.BLUE) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED, item: new Swatch(Color.RED) },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ]\r\n    ],\r\n    playerRow: 1,\r\n    playerCol: 1,\r\n    levelName: \"Swatches I\",\r\n    starRequirement3: 12,\r\n    starRequirement2: 16,\r\n    requiredToUnlock: 0\r\n};\r\n\r\nexport default LEVEL_SWATCHES_1;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst LEVEL_SWATCHES_2: GameConfig = {\r\n    id: \"czdtzyW72UKVkwfmYkRCAA==\",\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    Tip: If you make a mistake during the puzzle, you can press the\r\n                    <strong> undo </strong> and <strong> redo </strong> buttons in the quick menu\r\n                    to go back to a previous state. Alternatively, you can use your keyboard, by\r\n                    pressing <strong> Z </strong> (to undo) or <strong> Y </strong> (to redo).\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    If you feel like starting from the very beginning, press the restart button in\r\n                    the quick menu or press the <strong> R </strong> key on your keyboard.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.ORANGE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.ORANGE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.ORANGE, item: new Swatch(Color.ORANGE) },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE, item: new Swatch(Color.PURPLE) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE }\r\n        ]\r\n    ],\r\n    playerRow: 2,\r\n    playerCol: 2,\r\n    levelName: \"Swatches II\",\r\n    starRequirement3: 17,\r\n    starRequirement2: 20,\r\n    requiredToUnlock: 1\r\n};\r\n\r\nexport default LEVEL_SWATCHES_2;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst LEVEL_SWATCHES_3: GameConfig = {\r\n    id: \"ZascZkE+A0CjlYxEmU65cQ==\",\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    Tip: You can <strong> re-position </strong> or <strong> zoom in/out </strong>\r\n                    on the puzzle grid. Simply drag anywhere in the puzzle area to re-position the\r\n                    grid, and press the zoom in / zoom out buttons from the quick menu to adjust the\r\n                    zoom. You can do the same in the target window as well.\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    Additionally, you can adjust the size of the target window by dragging the\r\n                    resize handle (located in the bottom left corner of the window if playing on a\r\n                    desktop, or at the top of the window if playing on a mobile device).\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    If you are playing on a desktop, you can also re-position the target window by\r\n                    dragging the top bar of the window.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.GREEN, item: new Swatch(Color.GREEN) },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.YELLOW, item: new Swatch(Color.YELLOW) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.YELLOW }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.GREEN }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.GREEN }\r\n        ]\r\n    ],\r\n    playerRow: 3,\r\n    playerCol: 2,\r\n    levelName: \"Swatches III\",\r\n    starRequirement3: 47,\r\n    starRequirement2: 54,\r\n    requiredToUnlock: 1\r\n};\r\n\r\nexport default LEVEL_SWATCHES_3;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst TRICOLOR: GameConfig = {\r\n    id: \"DwaPoAeJnkmnOGFPsUKPIw==\",\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    Tip: If playing on a desktop, you can hold the <strong> Q </strong> key to view\r\n                    the solution overlayed on top of the puzzle grid.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW, item: new Swatch(Color.YELLOW) },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.RED, item: new Swatch(Color.RED) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.YELLOW }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE, item: new Swatch(Color.BLUE) },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ]\r\n    ],\r\n    playerRow: 1,\r\n    playerCol: 1,\r\n    levelName: \"Tricolor\",\r\n    starRequirement3: 17,\r\n    starRequirement2: 22,\r\n    requiredToUnlock: 3\r\n};\r\n\r\nexport default TRICOLOR;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst UP_THE_MIDDLE: GameConfig = {\r\n    id: \"N93y5GKYIEW2k+16R9tSOQ==\",\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.RED, item: new Swatch(Color.RED) },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.YELLOW, item: new Swatch(Color.YELLOW) },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.YELLOW }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.PURPLE, item: new Swatch(Color.PURPLE) },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.YELLOW }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.YELLOW },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ]\r\n    ],\r\n    playerRow: 2,\r\n    playerCol: 2,\r\n    levelName: \"Up the Middle\",\r\n    starRequirement3: 76,\r\n    starRequirement2: 90,\r\n    requiredToUnlock: 3\r\n};\r\n\r\nexport default UP_THE_MIDDLE;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst KEYS: GameConfig = {\r\n    id: \"TybPZyZJYEae4LbNHlbeYg==\",\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE, item: new Swatch(Color.BLUE) },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: false },\r\n            { hasTile: false },\r\n            { hasTile: false },\r\n            { hasTile: false }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.PURPLE },\r\n            { hasTile: true, solutionColor: Color.ORANGE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.PURPLE, item: new Swatch(Color.PURPLE) },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.ORANGE, item: new Swatch(Color.ORANGE) }\r\n        ]\r\n    ],\r\n    playerRow: 0,\r\n    playerCol: 0,\r\n    levelName: \"Keys\",\r\n    starRequirement3: 30,\r\n    starRequirement2: 35,\r\n    requiredToUnlock: 3\r\n};\r\n\r\nexport default KEYS;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst DARK_TILES_1: GameConfig = {\r\n    id: \"mWgTHtQTikqu7J9n3kjeDg==\",\r\n    description: <p>An introduction to dark tiles.</p>,\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    <strong>Dark tiles </strong> cannot change colors; they will always remain\r\n                    black, even if the player pieces moves across them while in a colored state.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.PURPLE, item: new Swatch(Color.PURPLE) },\r\n            { hasTile: true, tileColor: Color.DARK, solutionColor: Color.DARK },\r\n            { hasTile: true, solutionColor: Color.GREEN }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, tileColor:Color.DARK, solutionColor: Color.DARK },\r\n            { hasTile: true, solutionColor: Color.PURPLE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.GREEN, item: new Swatch(Color.GREEN) },\r\n            { hasTile: true, tileColor:Color.DARK, solutionColor: Color.DARK },\r\n            { hasTile: true, solutionColor: Color.ORANGE, item: new Swatch(Color.ORANGE) }\r\n        ]\r\n    ],\r\n    playerRow: 1,\r\n    playerCol: 1,\r\n    levelName: \"Dark Tiles I\",\r\n    starRequirement3: 14,\r\n    starRequirement2: 15,\r\n    requiredToUnlock: 7\r\n};\r\n\r\nexport default DARK_TILES_1;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst DARK_TILES_2: GameConfig = {\r\n    id: \"6CLrD8Z0TUK3lqRrQQB/qQ==\",\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.GREEN, item: new Swatch(Color.GREEN) },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.BLUE, item: new Swatch(Color.BLUE) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.BLUE }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.GREEN },\r\n            { hasTile: true, tileColor:Color.DARK, solutionColor: Color.DARK }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE, item: new Swatch(Color.ORANGE) },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, tileColor:Color.DARK, solutionColor: Color.DARK },\r\n            { hasTile: true, tileColor:Color.DARK, solutionColor: Color.DARK },\r\n        ]\r\n    ],\r\n    playerRow: 1,\r\n    playerCol: 1,\r\n    levelName: \"Dark Tiles II\",\r\n    starRequirement3: 50,\r\n    starRequirement2: 60,\r\n    requiredToUnlock: 8\r\n};\r\n\r\nexport default DARK_TILES_2;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst DARK_SWATCH: GameConfig = {\r\n    id: \"AZn/4XVi8EOd/qqCmO9icQ==\",\r\n    description: <p>An introduction to the dark swatch.</p>,\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    The <strong> dark swatch </strong> will turn the player piece black. While\r\n                    moving around in this state, the player piece will remove colors from any\r\n                    grid tile it lands on.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.DEFAULT },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED, item: new Swatch(Color.RED) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.DEFAULT },\r\n            { hasTile: true, solutionColor: Color.DEFAULT, item: new Swatch(Color.DARK) },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.DEFAULT },\r\n            { hasTile: true, solutionColor: Color.DEFAULT }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.RED },\r\n            { hasTile: true, solutionColor: Color.DEFAULT },\r\n            { hasTile: true, solutionColor: Color.RED }\r\n        ],\r\n    ],\r\n    playerRow: 3,\r\n    playerCol: 3,\r\n    levelName: \"Erasure\",\r\n    starRequirement3: 29,\r\n    starRequirement2: 34,\r\n    requiredToUnlock: 10\r\n};\r\n\r\nexport default DARK_SWATCH;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst ICE_1: GameConfig = {\r\n    id: \"rHfDwxEz5UWdA5RwOxn71Q==\",\r\n    description: <p>An introduction to ice tiles.</p>,\r\n    levelInstructions: [\r\n        {\r\n            element: (\r\n                <p>\r\n                    When the player piece moves onto an <strong> ice tile</strong>, it will keep\r\n                    moving in the same direction until it hits a wall or until it lands on a\r\n                    non-ice tile.\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            element: (\r\n                <p>\r\n                    Also, note that ice tiles can still be colored, just like normal tiles.\r\n                </p>\r\n            )\r\n        }\r\n    ],\r\n    gridConfig: [\r\n        [\r\n            { hasTile: true, solutionColor: Color.BLUE, item: new Swatch(Color.BLUE) },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: false }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true },\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true },\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true },\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true },\r\n            { hasTile: true, solutionColor: Color.BLUE, ice: true },\r\n            { hasTile: true, solutionColor: Color.BLUE, ice: true },\r\n            { hasTile: true, solutionColor: Color.ORANGE, ice: true }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.ORANGE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.BLUE },\r\n            { hasTile: true, solutionColor: Color.ORANGE, item: new Swatch(Color.ORANGE) }\r\n        ]\r\n    ],\r\n    playerRow: 3,\r\n    playerCol: 0,\r\n    levelName: \"Ice I\",\r\n    starRequirement3: 10,\r\n    starRequirement2: 12,\r\n    requiredToUnlock: 12\r\n};\r\n\r\nexport default ICE_1;\r\n","import { Color } from \"../constants\";\r\nimport Swatch from \"../../classes/swatch\";\r\nimport type { GameConfig } from \"../levels\";\r\n\r\nconst ICE_2: GameConfig = {\r\n    id: \"85WkcFxQFk6YcxuxVD/VEg==\",\r\n    gridConfig: [\r\n        [\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.GREEN, ice: true },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.RED, ice: true },\r\n            { hasTile: true, solutionColor: Color.RED, ice: true }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.GREEN, ice: true, item: new Swatch(Color.GREEN) },\r\n            { hasTile: true, solutionColor: Color.GREEN, ice: true },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.RED, ice: true }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, tileColor: Color.DARK, solutionColor: Color.DARK },\r\n            { hasTile: true, solutionColor: Color.GREEN, ice: true },\r\n            { hasTile: true, solutionColor: Color.GREEN, ice: true }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED, ice: true },\r\n            { hasTile: false },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true,\r\n                item: new Swatch(Color.YELLOW) }\r\n        ],\r\n        [\r\n            { hasTile: true, solutionColor: Color.RED, ice: true, item: new Swatch(Color.RED) },\r\n            { hasTile: true, solutionColor: Color.RED, ice: true },\r\n            { hasTile: true, solutionColor: Color.YELLOW, ice: true },\r\n            { hasTile: true, solutionColor: Color.RED, ice: true },\r\n            { hasTile: false }\r\n        ]\r\n    ],\r\n    playerRow: 2,\r\n    playerCol: 2,\r\n    levelName: \"Ice II\",\r\n    starRequirement3: 23,\r\n    starRequirement2: 26,\r\n    requiredToUnlock: 13\r\n};\r\n\r\nexport default ICE_2;\r\n","import { Link } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPlay, faLock } from '@fortawesome/free-solid-svg-icons';\r\nimport Grid from \"../../classes/grid\";\r\nimport LevelSelectGrid from \"../level-select-grid\";\r\nimport LEVELS from \"../../services/levels\";\r\nimport Star from \"../star\";\r\nimport \"./level-preview.scss\";\r\n\r\nimport type { LevelScore } from \"../../services/definitions\";\r\nimport type { GameConfig } from \"../../services/levels\";\r\nimport { ReactElement } from \"react\";\r\n\r\ninterface LevelPreviewProps {\r\n    selectedLevel: number | null, // 1-indexed\r\n    levelScoreMap: Record<string, LevelScore>,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number\r\n};\r\n\r\nconst STAR_SIZE = 16;\r\n\r\nexport function getLevelScoringTable(level: GameConfig): ReactElement {\r\n    return (\r\n        <table>\r\n            <tbody>\r\n                <tr>\r\n                    <td>\r\n                        <span className=\"star-container\">\r\n                            <Star filled size={STAR_SIZE} />\r\n                            <Star filled={false} size={STAR_SIZE} />\r\n                            <Star filled={false} size={STAR_SIZE} />\r\n                        </span>\r\n                    </td>\r\n                    <td>{\"Complete the level\\u2026\"}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                            <Star filled size={STAR_SIZE} />\r\n                            <Star filled size={STAR_SIZE} />\r\n                            <Star filled={false} size={STAR_SIZE} />\r\n                    </td>\r\n                    <td>{`\\u2026in ${level.starRequirement2} or fewer moves.`}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <Star filled size={STAR_SIZE} />\r\n                        <Star filled size={STAR_SIZE} />\r\n                        <Star filled size={STAR_SIZE} />\r\n                    </td>\r\n                    <td>{`\\u2026in ${level.starRequirement3} or fewer moves.`}</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    );\r\n}\r\n\r\nexport function getPersonalBestTable(starsScored:number, moves?: number): ReactElement {\r\n    const pbStars = [];\r\n    const pbMoves = (moves !== undefined && moves > 0) ? `${moves} moves` : \"-\";\r\n    for (let i = 1; i <= 3; i += 1) {\r\n        pbStars.push(\r\n            <Star filled={i <= starsScored} size={STAR_SIZE} key={`pb-star-${i}`} />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <table>\r\n            <tbody>\r\n                <tr>\r\n                    <td>\r\n                        <span className=\"star-container\">\r\n                            {pbStars}\r\n                        </span>\r\n                    </td>\r\n                    <td>{pbMoves}</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    );\r\n}\r\n\r\nexport default function LevelPreview(props: LevelPreviewProps) {\r\n    if (props.selectedLevel !== null && LEVELS[props.selectedLevel - 1]) {\r\n        const level = LEVELS[props.selectedLevel - 1];\r\n        const starsScored = props.starsScoredOnLevel(props.selectedLevel);\r\n        const toNextLevel = props.starsToUnlockLevel(props.selectedLevel);\r\n\r\n        // Level has not been unlocked\r\n        if (starsScored < 0) {\r\n            return (\r\n                <section className=\"level-preview\">\r\n                    <div className=\"locked-box\">\r\n                        <FontAwesomeIcon icon={faLock} />\r\n                    </div>\r\n                    <h2>{props.selectedLevel}. {level.levelName}</h2>\r\n                    <p className=\"unlock-text\">\r\n                        Collect a total of {level.requiredToUnlock}\r\n                        <span><Star filled size={STAR_SIZE} /></span>\r\n                        {\" to unlock this level (you need \"}\r\n                        {toNextLevel}\r\n                        <span><Star filled size={STAR_SIZE} /></span>\r\n                        {\" more).\"}\r\n                    </p>\r\n                </section>\r\n            );\r\n        }\r\n\r\n        const grid = new Grid(level.gridConfig);\r\n\r\n        return (\r\n            <section className=\"level-preview\">\r\n                <LevelSelectGrid grid={grid} />\r\n                <h2>{props.selectedLevel}. {level.levelName}</h2>\r\n                {level.description}\r\n                <Link to={`/game/${props.selectedLevel}`} className=\"play-btn\">\r\n                    <FontAwesomeIcon icon={faPlay} /> Play\r\n                </Link>\r\n\r\n                <hr />\r\n\r\n                <h3>Personal Best</h3>\r\n                {getPersonalBestTable(starsScored, props.levelScoreMap[level.id]?.moves)}\r\n\r\n                <h3>Scoring</h3>\r\n                {getLevelScoringTable(level)}\r\n            </section>\r\n        );\r\n    }\r\n\r\n    return <section className=\"level-preview\"></section>;\r\n}\r\n","import LEVELS from \"../../services/levels\";\r\nimport \"./level-select-buttons.scss\";\r\n\r\ninterface LevelSelectButtonsProps {\r\n    selectedLevel: number | null, // 1-indexed\r\n    isSelected: boolean,\r\n    setSelectedLevel: React.Dispatch<React.SetStateAction<number | null>>,\r\n    setIsSelected: React.Dispatch<React.SetStateAction<boolean>>,\r\n    containerRef: React.RefObject<HTMLElement>,\r\n    starsScoredOnLevel: (levelNum: number) => number\r\n};\r\n\r\nexport default function LevelSelectButtons(props: LevelSelectButtonsProps) {\r\n    const toggleSelected = (levelNum: number) => {\r\n        if (props.selectedLevel === levelNum) {\r\n            props.setIsSelected(!props.isSelected);\r\n        } else {\r\n            props.setIsSelected(true);\r\n            props.setSelectedLevel(levelNum);\r\n        }\r\n    }\r\n\r\n    const buttons = LEVELS.map((level, idx) => {\r\n        let btnClass = \"level-select-btn\";\r\n        const levelNum = idx + 1;\r\n        const starsScored = props.starsScoredOnLevel(levelNum);\r\n\r\n        // Button is currently being previewed\r\n        if (props.isSelected && (props.selectedLevel === levelNum)) {\r\n            btnClass += \" btn-highlight\";\r\n        }\r\n\r\n        // Gotten 3 stars on this level\r\n        else if (starsScored >= 3) {\r\n            btnClass += \" btn-star-3\";\r\n        }\r\n\r\n        // Gotten 1 or 2 stars on this level\r\n        else if (starsScored > 0) {\r\n            btnClass += \" btn-star-1\";\r\n        }\r\n\r\n        // Level not unlocked yet\r\n        else if (starsScored < 0) {\r\n            btnClass += \" btn-locked\";\r\n        }\r\n\r\n        return (\r\n            <button className={btnClass} key={`level-btn-${level.id}`}\r\n                onClick={toggleSelected.bind(null, levelNum)}\r\n                aria-label={`Toggle preview of level ${levelNum}`}>\r\n                {levelNum}\r\n            </button>\r\n        );\r\n    });\r\n\r\n    return (\r\n        <section className=\"level-btn-container\" ref={props.containerRef}>\r\n            {buttons}\r\n        </section>\r\n    );\r\n}\r\n","import { Link } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPlay, faLock } from '@fortawesome/free-solid-svg-icons';\r\nimport Grid from \"../../classes/grid\";\r\nimport LevelSelectGrid from \"../level-select-grid\";\r\nimport Star from \"../star\";\r\nimport LEVELS from \"../../services/levels\";\r\nimport { getPersonalBestTable, getLevelScoringTable } from \"../level-preview\";\r\nimport \"./level-select-mobile.scss\";\r\n\r\nimport type { LevelScore } from \"../../services/definitions\";\r\n\r\nconst STAR_SIZE = 16;\r\n\r\ninterface LevelSelectMobileProps {\r\n    selectedLevel: number | null, // 1-indexed\r\n    isSelected: boolean,\r\n    levelScoreMap: Record<string, LevelScore>,\r\n    setSelectedLevel: React.Dispatch<React.SetStateAction<number | null>>,\r\n    setIsSelected: React.Dispatch<React.SetStateAction<boolean>>,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number\r\n};\r\n\r\nexport default function LevelSelectMobile(props: LevelSelectMobileProps) {\r\n    const toggleSelected = (levelNum: number) => {\r\n        if (props.selectedLevel === levelNum) {\r\n            props.setIsSelected(!props.isSelected);\r\n        } else {\r\n            props.setIsSelected(true);\r\n            props.setSelectedLevel(levelNum);\r\n        }\r\n    }\r\n\r\n    const buttons = LEVELS.map((level, idx) => {\r\n        let btnClass = \"level-select-mobile-btn\";\r\n        const levelNum = idx + 1;\r\n        const starsScored = props.starsScoredOnLevel(levelNum);\r\n\r\n        // Button is currently being previewed\r\n        if (props.isSelected && (props.selectedLevel === levelNum)) {\r\n            btnClass += \" btn-highlight\";\r\n        }\r\n\r\n        // Gotten 3 stars on this level\r\n        else if (starsScored >= 3) {\r\n            btnClass += \" btn-star-3\";\r\n        }\r\n\r\n        // Gotten 1 or 2 stars on this level\r\n        else if (starsScored > 0) {\r\n            btnClass += \" btn-star-1\";\r\n        }\r\n\r\n        // Level not unlocked yet\r\n        else if (starsScored < 0) {\r\n            btnClass += \" btn-locked\";\r\n        }\r\n\r\n        // Level preview\r\n        let levelPreview = null;\r\n        if (starsScored < 0) {\r\n            const toNextLevel = props.starsToUnlockLevel(levelNum);\r\n            let className = \"level-preview-mobile level-preview-locked\";\r\n            className += (props.isSelected && (props.selectedLevel === levelNum)) ?\r\n                \" preview-open\" : \"\";\r\n\r\n            levelPreview = (\r\n                <section className={className}>\r\n                    <div className=\"level-preview-padding\">\r\n                        <div className=\"locked-box\">\r\n                            <FontAwesomeIcon icon={faLock} />\r\n                        </div>\r\n                        <p className=\"unlock-text\">\r\n                            Collect a total of {level.requiredToUnlock}\r\n                            <span><Star filled size={STAR_SIZE} /></span>\r\n                            {\" to unlock this level (you need \"}\r\n                            {toNextLevel}\r\n                            <span><Star filled size={STAR_SIZE} /></span>\r\n                            {\" more).\"}\r\n                        </p>\r\n                    </div>\r\n                </section>\r\n            );\r\n        } else {\r\n            const grid = new Grid(level.gridConfig);\r\n            let className = \"level-preview-mobile\";\r\n            className += (props.isSelected && (props.selectedLevel === levelNum)) ?\r\n                \" preview-open\" : \"\";\r\n\r\n            levelPreview = (\r\n                <section className={className}>\r\n                    <div className=\"level-preview-padding\">\r\n                        <LevelSelectGrid grid={grid} />\r\n                        {level.description}\r\n                        <Link to={`/game/${props.selectedLevel}`} className=\"play-btn\">\r\n                            <FontAwesomeIcon icon={faPlay} /> Play\r\n                        </Link>\r\n\r\n                        <hr />\r\n\r\n                        <h3>Personal Best</h3>\r\n                        {getPersonalBestTable(starsScored, props.levelScoreMap[level.id]?.moves)}\r\n\r\n                        <h3>Scoring</h3>\r\n                        {getLevelScoringTable(level)}\r\n                    </div>\r\n                </section>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div key={`level-btn-mobile-${level.id}`}>\r\n                <button className={btnClass}\r\n                    onClick={toggleSelected.bind(null, levelNum)}\r\n                    aria-label={`Toggle preview of level ${levelNum}`}>\r\n                    <h2>{levelNum}. {level.levelName}</h2>\r\n                </button>\r\n                {levelPreview}\r\n            </div>\r\n        );\r\n    });\r\n\r\n    return (\r\n        <main className=\"level-select-mobile\">\r\n            {buttons}\r\n        </main>\r\n    );\r\n}\r\n","import React, { useState, useRef } from \"react\";\r\nimport LevelSelectTopBar from \"../level-select-top-bar\";\r\nimport LevelPreview from \"../level-preview\";\r\nimport LevelSelectButtons from \"../level-select-buttons\";\r\nimport LevelSelectMobile from \"../level-select-mobile\";\r\nimport \"./level-select.scss\";\r\n\r\nimport type { MouseEvent } from \"react\";\r\nimport type { LevelScore } from \"../../services/definitions\";\r\n\r\ninterface LevelSelectProps {\r\n    starCount: number,\r\n    levelScoreMap: Record<string, LevelScore>,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number\r\n};\r\n\r\nexport default function LevelSelect(props: LevelSelectProps) {\r\n    const [selectedLevel, setSelectedLevel] = useState<number | null>(null);\r\n    const [isSelected, setIsSelected] = useState<boolean>(false);\r\n\r\n    // Handler to close the level preview if user clicks outside\r\n    const btnContainerRef = useRef<HTMLElement>(null);\r\n    const onBtnContainerClick = function (event: MouseEvent) {\r\n        event.preventDefault();\r\n        if (event.target === btnContainerRef.current) {\r\n            setIsSelected(false);\r\n        }\r\n    };\r\n\r\n    const mainClassName = isSelected ? \"level-select-main level-selected\" : \"level-select-main\";\r\n    return (\r\n        <div className=\"level-select\">\r\n            <LevelSelectTopBar starCount={props.starCount} />\r\n            <main className={mainClassName} onClick={onBtnContainerClick}>\r\n                <LevelSelectButtons selectedLevel={selectedLevel} isSelected={isSelected}\r\n                    setSelectedLevel={setSelectedLevel} setIsSelected={setIsSelected}\r\n                    containerRef={btnContainerRef} starsScoredOnLevel={props.starsScoredOnLevel} />\r\n                <LevelPreview selectedLevel={selectedLevel}\r\n                    levelScoreMap={props.levelScoreMap}\r\n                    starsScoredOnLevel={props.starsScoredOnLevel}\r\n                    starsToUnlockLevel={props.starsToUnlockLevel} />\r\n            </main>\r\n\r\n            <LevelSelectMobile selectedLevel={selectedLevel} isSelected={isSelected}\r\n                    setSelectedLevel={setSelectedLevel} setIsSelected={setIsSelected}\r\n                    starsScoredOnLevel={props.starsScoredOnLevel}\r\n                    levelScoreMap={props.levelScoreMap}\r\n                    starsToUnlockLevel={props.starsToUnlockLevel} />\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useContext, useEffect } from \"react\";\r\nimport { usePrevious } from \"../../services/hooks\";\r\nimport { easeQuadInOut, easeQuadIn, easeQuadOut, easeLinear } from \"d3-ease\";\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport { Color, PlayerMovementType } from \"../../services/constants\";\r\nimport \"./player.scss\";\r\n\r\nconst ANIM_FRAMES = 70;\r\nconst ANIM_FRAMES_ICE = 35;\r\nconst ANIM_INTERVAL = 5;\r\n\r\ninterface PlayerProps {\r\n    color?: Color,\r\n    row: number,\r\n    col: number,\r\n    playerMovementType?: PlayerMovementType,\r\n    movementToggle: boolean,\r\n    onAnimationEnd: Function\r\n}\r\n\r\nexport default function PlayerComponent(props: PlayerProps) {\r\n    const { row, col, movementToggle } = props;\r\n    const [rowPosition, setRowPosition] = useState(row);\r\n    const [colPosition, setColPosition] = useState(col);\r\n    const offset = useContext(GridOffsetContext);\r\n    const tileSize = useContext(TileSizeContext);\r\n    const prevProps = usePrevious({ row, col });\r\n\r\n    const PLAYER_SIZE = (tileSize * 5) / 6;\r\n    const QUARTER_DIFF = (tileSize - PLAYER_SIZE) / 2;\r\n\r\n    useEffect(() => {\r\n        // Only animate player movement if it's toggled on and we have an initial starting position\r\n        if (movementToggle && prevProps) {\r\n            let frameCount = 0;\r\n\r\n            // Set easing function and animation frames\r\n            let easeFn = easeQuadInOut;\r\n            let animationFrames = ANIM_FRAMES;\r\n\r\n            if (props.playerMovementType === PlayerMovementType.TO_ICE) {\r\n                easeFn = easeQuadIn;\r\n            } else if (props.playerMovementType === PlayerMovementType.FROM_ICE) {\r\n                easeFn = easeQuadOut;\r\n            } else if (props.playerMovementType === PlayerMovementType.ON_ICE) {\r\n                easeFn = easeLinear;\r\n                animationFrames = ANIM_FRAMES_ICE;\r\n            }\r\n\r\n            // Perform animation\r\n            const interval = setInterval(() => {\r\n                if (frameCount >= animationFrames) {\r\n                    clearInterval(interval);\r\n                    props.onAnimationEnd();\r\n                } else {\r\n                    frameCount += 1;\r\n                    const increment = easeFn(frameCount / animationFrames);\r\n                    setRowPosition(prevProps.row + ((row - prevProps.row) * increment));\r\n                    setColPosition(prevProps.col + ((col - prevProps.col) * increment));\r\n                }\r\n            }, ANIM_INTERVAL);\r\n        } else {\r\n            setRowPosition(row);\r\n            setColPosition(col);\r\n        }\r\n\r\n    }, [ row, col, movementToggle ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const color = props.color ?? Color.DEFAULT;\r\n    const colorClass = `player-color bg-${color}`;\r\n    const borderWidth = Math.ceil(tileSize / 12);\r\n\r\n    const playerStyle = {\r\n        borderRadius: `${PLAYER_SIZE}px`,\r\n        borderWidth: `${borderWidth}px`,\r\n        height: `${PLAYER_SIZE}px`,\r\n        left: `${(colPosition * tileSize) + QUARTER_DIFF + offset.x}px`,\r\n        top: `${(rowPosition * tileSize) + QUARTER_DIFF + offset.y}px`,\r\n        width: `${PLAYER_SIZE}px`\r\n    };\r\n\r\n    const playerBodyStyle = {\r\n        borderRadius: `${PLAYER_SIZE}px`,\r\n        borderWidth: `${borderWidth}px`,\r\n    };\r\n\r\n    return (\r\n        <div className=\"player\" style={playerStyle}>\r\n            <div className={colorClass} style={playerBodyStyle}></div>\r\n            <div className=\"player-border\" style={playerBodyStyle}></div>\r\n        </div>\r\n    );\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\nimport type { MutableRefObject } from 'react';\r\n\r\n/**\r\n * Credit: https://gist.github.com/btoo/65e7d4303f49299c785d38f8758525e6\r\n */\r\nexport function usePrevious<T> (value: T): MutableRefObject<T | undefined>['current'] {\r\n    const ref = useRef<T>();\r\n    useEffect(() => {\r\n        ref.current = value;\r\n    }, [ value ]);\r\n\r\n    return ref.current;\r\n  }\r\n","/**\r\n * Returns promise that resolves after ms milliseconds\r\n */\r\nexport function sleep(ms: number) {\r\n    return new Promise(resolve => {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\r\n\r\nexport function getBoundValue(val: number, upperBound: number, lowerBound: number) {\r\n    return Math.min(Math.max(lowerBound, val), upperBound);\r\n\r\n}\r\n\r\nexport function isInElementById(node: (HTMLElement | null), id: string): boolean {\r\n    while (node) {\r\n        if (node?.id === id) {\r\n            return true;\r\n        }\r\n\r\n        node = node.parentElement;\r\n    }\r\n\r\n    return false;\r\n}\r\n","import { useState, useEffect, useContext } from \"react\";\r\nimport { useResizeDetector } from 'react-resize-detector/build/withPolyfill';\r\nimport PlayerComponent from \"../player\";\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport { sleep, getBoundValue } from \"../../services/util\";\r\nimport {\r\n    DEFAULT_SOLUTION_CONTAINER_SIZE,\r\n    TOP_MENU_HEIGHT,\r\n    GAME_MOBILE_WIDTH,\r\n    PlayerMovementType\r\n} from \"../../services/constants\";\r\nimport \"./grid.scss\";\r\n\r\nimport type Grid from \"../../classes/grid\";\r\nimport type { Color } from \"../../services/constants\";\r\nimport type { PointerEvent } from \"react\";\r\n\r\nconst DRAG_THRESHOLD = 100;\r\nconst MIN_DRAG_X_PCT = -0.5;\r\nconst MAX_DRAG_X_PCT = 0.5;\r\nconst MIN_DRAG_Y_PCT = -0.5;\r\nconst MAX_DRAG_Y_PCT = 0.5;\r\n\r\ninterface GridProps {\r\n    grid: Grid,\r\n    playerRow: number,\r\n    playerCol: number,\r\n    playerColor: Color,\r\n    playerMovementType?: PlayerMovementType,\r\n    levelNumber: number,\r\n    showSolution: boolean,\r\n    isPlayerMoving: boolean,\r\n    shouldResetLayout: boolean,\r\n    onPlayerAnimationEnd: () => void,\r\n    onTilePress: (row: number, col: number) => void,\r\n    dragHandler: (bool: boolean) => void,\r\n    onGridSizeChange: (width?: number, height?: number) => void\r\n}\r\n\r\nexport default function GridComponent(props: GridProps) {\r\n    const [ isPointerDown, setIsPointerDown ] = useState(false);\r\n    const [ isDragging, setIsDragging ] = useState(false);\r\n    const [ distanceDragged, setDistanceDragged ] = useState(0);\r\n    const [ lastPointerX, setLastPointerX] = useState(0);\r\n    const [ lastPointerY, setLastPointerY] = useState(0);\r\n    const [ offsetPctX, setOffsetPctX ] = useState(0);\r\n    const [ offsetPctY, setOffsetPctY ] = useState(0);\r\n    const [ hasInitialOffset, setHasInitialOffset ] = useState(false);\r\n    const tileSize = useContext(TileSizeContext);\r\n\r\n    const { width, height, ref } = useResizeDetector({\r\n        refreshMode: \"throttle\",\r\n        refreshRate: 10\r\n    });\r\n\r\n    // Start with grid in the center\r\n    const offset = props.grid.getCenterOffset(tileSize, width ?? 0, height ?? 0);\r\n\r\n    // Add draggable offset\r\n    offset.x += (offsetPctX * (width ?? 0));\r\n    offset.y += (offsetPctY * (height ?? 0));\r\n\r\n    const setInitialOffset = () => {\r\n        // Do not do anything if resize detector has not started\r\n        if (!width || !height) {\r\n            return;\r\n        }\r\n\r\n        setOffsetPctY(TOP_MENU_HEIGHT / (2 * height));\r\n\r\n        if (width < GAME_MOBILE_WIDTH) {\r\n            setOffsetPctX(0);\r\n        } else {\r\n            // Account for solution container if we are in desktop view\r\n            setOffsetPctX((-DEFAULT_SOLUTION_CONTAINER_SIZE) / (2 * width));\r\n        }\r\n\r\n        setHasInitialOffset(true);\r\n    };\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        // Call grid size handler\r\n        props.onGridSizeChange(width, height);\r\n\r\n        // Do not continue if we've already set the offset\r\n        if (hasInitialOffset) {\r\n            return;\r\n        }\r\n\r\n        // Otherwise default offset percentage after we have the width and height of the container\r\n        setInitialOffset();\r\n    }, [ width, height ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Reset to default offset percentage after we switch to a new level\r\n    useEffect(() => {\r\n        setInitialOffset();\r\n    }, [ props.levelNumber ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Reset to default offset percentage if the reset layout button was pressed\r\n    useEffect(() => {\r\n        if (props.shouldResetLayout) {\r\n            setInitialOffset();\r\n        }\r\n    }, [ props.shouldResetLayout ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const gridElements = props.isPlayerMoving ? props.grid.renderElements(props.showSolution) :\r\n        props.grid.renderElements(\r\n            props.showSolution,\r\n            props.playerRow,\r\n            props.playerCol,\r\n            props.onTilePress\r\n        );\r\n\r\n    const onPointerDown = (event: PointerEvent): void => {\r\n        setIsPointerDown(true);\r\n        setDistanceDragged(0);\r\n        setIsDragging(false);\r\n        setLastPointerX(event.clientX);\r\n        setLastPointerY(event.clientY);\r\n    };\r\n\r\n    const onPointerMove = (event: PointerEvent): void => {\r\n        // Do not process unless the pointer is pressed down\r\n        if (!isPointerDown) {\r\n            return;\r\n        }\r\n\r\n        const distX = Math.abs(event.clientX - lastPointerX);\r\n        const distY = Math.abs(event.clientY - lastPointerY);\r\n        const totalDist = distanceDragged + (distX ** 2) + (distY ** 2);\r\n\r\n        setDistanceDragged(totalDist);\r\n\r\n        // Process drag if enough distance has been moved\r\n        if (isDragging || totalDist >= DRAG_THRESHOLD) {\r\n            setIsDragging(true);\r\n            props.dragHandler(true);\r\n            ref.current && ref.current.setPointerCapture(event.pointerId);\r\n\r\n            // Set the offset\r\n            let nextOffsetPctX = offsetPctX + ((event.clientX - lastPointerX) / (width || 1));\r\n            nextOffsetPctX = getBoundValue(nextOffsetPctX, MAX_DRAG_X_PCT, MIN_DRAG_X_PCT);\r\n\r\n            let nextOffsetPctY = offsetPctY + ((event.clientY - lastPointerY) / (height || 1));\r\n            nextOffsetPctY = getBoundValue(nextOffsetPctY, MAX_DRAG_Y_PCT, MIN_DRAG_Y_PCT);\r\n\r\n            setOffsetPctX(nextOffsetPctX);\r\n            setOffsetPctY(nextOffsetPctY);\r\n\r\n            // Set last pointer coordinates\r\n            setLastPointerX(event.clientX);\r\n            setLastPointerY(event.clientY);\r\n        }\r\n    };\r\n\r\n    const onPointerUp = async (event: PointerEvent) => {\r\n        const wasDragging = isDragging;\r\n\r\n        setIsPointerDown(false);\r\n        setDistanceDragged(0);\r\n        setIsDragging(false);\r\n        ref.current && ref.current.releasePointerCapture(event.pointerId);\r\n\r\n        // Release the drag on the following cycle\r\n        if (wasDragging) {\r\n            await sleep(0);\r\n        }\r\n\r\n        props.dragHandler(false);\r\n    };\r\n\r\n    const gridContainerProps: Record<string, any> = {\r\n        className: `tile-grid ${isDragging ? \"grid-dragging\" : \"\"}`,\r\n        ref,\r\n        onPointerDown,\r\n        onPointerUp\r\n    };\r\n\r\n    if (isPointerDown) {\r\n        gridContainerProps.onPointerMove = onPointerMove;\r\n    }\r\n\r\n    return (\r\n        <GridOffsetContext.Provider value={offset}>\r\n            <div {...gridContainerProps}>\r\n\r\n                { gridElements }\r\n                <PlayerComponent color={props.playerColor} row={props.playerRow}\r\n                    col={props.playerCol} movementToggle={props.isPlayerMoving}\r\n                    playerMovementType={props.playerMovementType}\r\n                    onAnimationEnd={props.onPlayerAnimationEnd} />\r\n            </div>\r\n        </GridOffsetContext.Provider>\r\n    );\r\n}\r\n","import { Link } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n    faThLarge,\r\n    faQuestionCircle,\r\n    faCog,\r\n    faSync,\r\n    faInfoCircle\r\n} from '@fortawesome/free-solid-svg-icons';\r\nimport \"./game-menu.scss\";\r\n\r\ninterface GameMenuProps {\r\n    isOpen: boolean,\r\n    setOpen: (isOpen: boolean) => void,\r\n    showSettings: () => void,\r\n    showInstructions: () => void,\r\n    resetLayout: () => void,\r\n    startTutorial?: () => void\r\n}\r\n\r\nexport default function GameMenu(props: GameMenuProps) {\r\n    const openClass = props.isOpen ? \"game-menu-open\" : \"game-menu-closed\";\r\n    const overlayClass = `game-menu-overlay ${openClass}`;\r\n    const navClass = `game-menu-nav ${openClass}`;\r\n    const tabIndex = props.isOpen ? 0 : -1;\r\n\r\n    const onResetLayoutClick = () => {\r\n        props.resetLayout();\r\n        props.setOpen(false);\r\n    };\r\n\r\n    const onViewTutorial = () => {\r\n        if (!props.startTutorial) {\r\n            return;\r\n        }\r\n\r\n        props.startTutorial();\r\n        props.setOpen(false);\r\n    };\r\n\r\n    // TODO: Add settings button back in once there are more in-game settings\r\n    const settingsBtn = (\r\n        <button className=\"game-menu-btn\" tabIndex={tabIndex}\r\n            onClick={props.showSettings}>\r\n            <FontAwesomeIcon icon={faCog} />\r\n            <span>Settings</span>\r\n        </button>\r\n    );\r\n\r\n    const tutorialBtn = props.startTutorial ? (\r\n        <button className=\"game-menu-btn\" tabIndex={tabIndex} onClick={onViewTutorial}>\r\n            <FontAwesomeIcon icon={faInfoCircle} />\r\n            <span>View Tutorial</span>\r\n        </button>\r\n    ): null;\r\n\r\n    return (\r\n        <div className=\"game-menu\">\r\n            <div className={overlayClass} onClick={props.setOpen.bind(null, false)}></div>\r\n            <nav className={navClass}>\r\n                <Link to=\"/level-select\" tabIndex={tabIndex}\r\n                    className=\"game-menu-btn game-menu-first\">\r\n                    <FontAwesomeIcon icon={faThLarge} />\r\n                    <span>Level Select</span>\r\n                </Link>\r\n                <button className=\"game-menu-btn\" tabIndex={tabIndex}\r\n                    onClick={props.showInstructions}>\r\n                    <FontAwesomeIcon icon={faQuestionCircle} />\r\n                    <span>How to Play</span>\r\n                </button>\r\n                {tutorialBtn}\r\n                <button className=\"game-menu-btn game-menu-last\" tabIndex={tabIndex}\r\n                    onClick={onResetLayoutClick}>\r\n                    <FontAwesomeIcon icon={faSync} />\r\n                    <span>Reset Layout</span>\r\n                </button>\r\n            </nav>\r\n        </div>\r\n    );\r\n}\r\n","import { Turn as Hamburger } from \"hamburger-react\";\r\nimport \"./game-top-bar.scss\";\r\n\r\ninterface GameTopBarProps {\r\n    isMenuOpen: boolean,\r\n    setMenuOpen: (isOpen: boolean) => void,\r\n    levelNumber: number,\r\n    levelName: string,\r\n    movesTaken: number\r\n}\r\n\r\nexport default function GameTopBar(props: GameTopBarProps) {\r\n    return (\r\n        <header className=\"top-bar game-top-bar\">\r\n            <div className=\"hamburger-btn\">\r\n                <Hamburger toggled={props.isMenuOpen} onToggle={props.setMenuOpen} rounded\r\n                    size={24} label=\"Toggle menu\" hideOutline={false}></Hamburger>\r\n            </div>\r\n            <div className=\"game-level\">\r\n                <h1 className=\"top-bar-text\">{props.levelNumber}. {props.levelName}</h1>\r\n            </div>\r\n            <div className=\"moves-taken\">\r\n                <span className=\"top-bar-text\">Moves: {props.movesTaken}</span>\r\n            </div>\r\n            <div className=\"clearfix\"></div>\r\n        </header>\r\n    );\r\n}\r\n","import GameMenu from \"../game-menu\";\r\nimport GameTopBar from \"../game-top-bar\";\r\nimport \"./game-hud.scss\";\r\n\r\ninterface GameHUDProps {\r\n    movesTaken: number,\r\n    levelNumber: number,\r\n    levelName: string,\r\n    isMenuOpen: boolean,\r\n    setMenuOpen: (isOpen: boolean) => void,\r\n    showSettings: () => void,\r\n    showInstructions: () => void,\r\n    resetLayout: () => void,\r\n    startTutorial?: () => void\r\n}\r\n\r\nexport default function GameHUD(props: GameHUDProps) {\r\n    return (\r\n        <div className=\"game-hud\">\r\n            <GameTopBar isMenuOpen={props.isMenuOpen}\r\n                setMenuOpen={props.setMenuOpen}\r\n                levelNumber={props.levelNumber}\r\n                levelName={props.levelName}\r\n                movesTaken={props.movesTaken} />\r\n            <GameMenu\r\n                isOpen={props.isMenuOpen}\r\n                setOpen={props.setMenuOpen}\r\n                showSettings={props.showSettings}\r\n                showInstructions={props.showInstructions}\r\n                resetLayout={props.resetLayout}\r\n                startTutorial={props.startTutorial} />\r\n        </div>\r\n    );\r\n}\r\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSync, faThLarge, faPlay, faLock } from '@fortawesome/free-solid-svg-icons';\r\nimport { Link } from \"react-router-dom\";\r\nimport Star from \"../star\";\r\nimport LEVELS from \"../../services/levels\";\r\nimport \"./game-complete.scss\";\r\n\r\ninterface GameCompleteProps {\r\n    levelNumber: number,\r\n    stars: number,\r\n    restartHandler: () => void,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number\r\n};\r\n\r\nconst STAR_SIZE = 50;\r\nconst STAR_TEXT_SIZE = 16;\r\n\r\nexport default function GameComplete(props: GameCompleteProps) {\r\n    let nextBtn = null;\r\n    let nextUnlockElement = null;\r\n    let starText = null;\r\n\r\n    if (LEVELS[props.levelNumber]) {\r\n        const level = LEVELS[props.levelNumber];\r\n\r\n        if (props.starsScoredOnLevel(props.levelNumber + 1) >= 0) {\r\n            nextBtn = (\r\n                <Link to={`/game/${props.levelNumber + 1}`} className=\"level-complete-btn\">\r\n                    <FontAwesomeIcon icon={faPlay} /> Next Level\r\n                </Link>\r\n            );\r\n        } else {\r\n            const toNextLevel = props.starsToUnlockLevel(props.levelNumber + 1);\r\n            nextUnlockElement = (\r\n                <p className=\"level-complete-unlock-text\">\r\n                    Collect a total of {level.requiredToUnlock}\r\n                    <span><Star filled size={STAR_TEXT_SIZE} /></span>\r\n                    {\" to unlock the next level (you need \"}\r\n                    {toNextLevel}\r\n                    <span><Star filled size={STAR_TEXT_SIZE} /></span>\r\n                    {\" more).\"}\r\n                </p>\r\n            );\r\n\r\n            nextBtn = (\r\n                <button className=\"level-complete-btn locked-next-btn\">\r\n                    <FontAwesomeIcon icon={faLock} /> Next Level\r\n                </button>\r\n            );\r\n        }\r\n    }\r\n\r\n    if (LEVELS[props.levelNumber - 1] && props.stars < 3) {\r\n        const level = LEVELS[props.levelNumber - 1];\r\n        starText = (\r\n            <div className=\"level-complete-3s-text\">\r\n                Complete the puzzle in <strong>{level.starRequirement3}</strong> moves to earn a 3\r\n                <span><Star filled size={STAR_TEXT_SIZE} /></span> {\" score.\"}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const stars = [];\r\n    for (let i = 1; i <= 3; i += 1) {\r\n        stars.push(\r\n            <Star filled={i <= props.stars} className={`level-complete-star lcs-${i}`}\r\n                size={STAR_SIZE} key={`lcs-${i}`} />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"level-complete\">\r\n            <div className=\"level-complete-main\">\r\n                <div className=\"level-complete-star-container\">\r\n                    {stars}\r\n                </div>\r\n                <div className=\"level-complete-msg\">Puzzle Completed!</div>\r\n                {starText}\r\n                <div className=\"level-complete-btn-container\">\r\n                    <Link to=\"/level-select\" className=\"level-complete-btn\">\r\n                        <FontAwesomeIcon icon={faThLarge} /> Level Select\r\n                    </Link>\r\n                    <button className=\"level-complete-btn\" onClick={props.restartHandler}>\r\n                        <FontAwesomeIcon icon={faSync} /> Restart\r\n                    </button>\r\n                    {nextBtn}\r\n                </div>\r\n                {nextUnlockElement}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useContext } from \"react\";\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport \"./solution-player-cursor.scss\";\r\n\r\nexport default function SolutionPlayerCursor(props: { row: number, col: number }) {\r\n    const offset = useContext(GridOffsetContext);\r\n    const tileSize = useContext(TileSizeContext);\r\n\r\n    const cursorStyle = {\r\n        height: `${tileSize}px`,\r\n        left: `${(props.col * tileSize) + offset.x}px`,\r\n        top: `${(props.row * tileSize) + offset.y}px`,\r\n        width: `${tileSize}px`\r\n    };\r\n\r\n    const cornerStyle = {\r\n        borderWidth: Math.floor((tileSize * 3) / 20),\r\n        height: Math.floor(tileSize / 5),\r\n        width: Math.floor(tileSize / 5),\r\n    };\r\n\r\n    return (\r\n        <div className=\"solution-player-cursor\" style={cursorStyle}>\r\n            <div className=\"cursor-corner cursor-corner-top-left\" style={cornerStyle}></div>\r\n            <div className=\"cursor-corner cursor-corner-top-right\" style={cornerStyle}></div>\r\n            <div className=\"cursor-corner cursor-corner-bottom-left\" style={cornerStyle}></div>\r\n            <div className=\"cursor-corner cursor-corner-bottom-right\" style={cornerStyle}></div>\r\n        </div>\r\n    );\r\n}\r\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faSearchPlus, faSearchMinus } from '@fortawesome/free-solid-svg-icons';\r\nimport \"./solution-adjust-menu.scss\";\r\n\r\ninterface SolutionAdjustMenuProps {\r\n    canZoomIn: boolean,\r\n    canZoomOut: boolean,\r\n    zoomInHandler: () => void,\r\n    zoomOutHandler: () => void\r\n}\r\n\r\nexport default function SolutionAdjustMenu(props: SolutionAdjustMenuProps) {\r\n    const zoomInClass = `adjust-btn ${!props.canZoomIn ? \" adjust-disabled\" : \"\"}`;\r\n    const zoomOutClass = `adjust-btn ${!props.canZoomOut ? \" adjust-disabled\" : \"\"}`;\r\n\r\n    return (\r\n        <div id=\"solution-adjust-menu\" className=\"adjust-menu solution-adjust-menu\">\r\n            <div className={zoomInClass}>\r\n                <button tabIndex={0} onClick={props.zoomInHandler} aria-label=\"Zoom in\">\r\n                    <FontAwesomeIcon icon={faSearchPlus} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Zoom In</div>\r\n            </div>\r\n\r\n            <div className={zoomOutClass}>\r\n                <button tabIndex={0} onClick={props.zoomOutHandler} aria-label=\"Zoom out\">\r\n                    <FontAwesomeIcon icon={faSearchMinus} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Zoom Out</div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useEffect, useRef } from \"react\";\r\nimport { Resizable } from \"react-resizable\";\r\nimport { useResizeDetector } from 'react-resize-detector/build/withPolyfill';\r\nimport { GridOffsetContext, TileSizeContext } from \"../../services/context\";\r\nimport { getBoundValue, isInElementById } from \"../../services/util\";\r\nimport SolutionPlayerCursor from \"../solution-player-cursor\";\r\nimport SolutionAdjustMenu from \"../solution-adjust-menu\";\r\nimport {\r\n    TILES_SIZES,\r\n    DEFAULT_SOLUTION_TILE_SIZE,\r\n    DEFAULT_SOLUTION_CONTAINER_SIZE,\r\n    TOP_MENU_HEIGHT,\r\n    GAME_MOBILE_WIDTH\r\n} from \"../../services/constants\";\r\nimport \"./solution.scss\";\r\n\r\nimport type Grid from \"../../classes/grid\";\r\nimport type { SyntheticEvent } from \"react\";\r\nimport type { ResizeCallbackData } from \"react-resizable\";\r\n\r\nconst MIN_GRID_DRAG_X_PCT = -0.5;\r\nconst MAX_GRID_DRAG_X_PCT = 0.5;\r\nconst MIN_GRID_DRAG_Y_PCT = -0.5;\r\nconst MAX_GRID_DRAG_Y_PCT = 0.5;\r\nconst DEFAULT_TILE_SIZE_INDEX = 2;\r\nconst DEFAULT_CONTAINER_OFFSET = 4;\r\nconst MIN_CONTAINER_SIZE = 100;\r\nconst MAX_CONTAINER_SIZE = 500;\r\nconst CONTAINER_LEFT_ADJUST = 12;\r\nconst CONTAINER_BOTTOM_ADJUST = TOP_MENU_HEIGHT + 36;\r\nconst DEFAULT_MOBILE_HEIGHT_PCT = 0.35;\r\nconst MAX_MOBILE_HEIGHT_PCT = 0.8;\r\nconst MIN_MOBILE_HEIGHT = 35;\r\n\r\ninterface SolutionProps {\r\n    grid: Grid,\r\n    playerRow: number,\r\n    playerCol: number,\r\n    levelNumber: number,\r\n    shouldResetLayout: boolean,\r\n    gameOver: boolean,\r\n    isMenuOpen: boolean,\r\n    gridWidth?: number,\r\n    gridHeight?: number,\r\n    appHeight?: number\r\n};\r\n\r\nfunction getBoundedContainerOffsetPctX(\r\n    offsetPct: number,\r\n    solutionWidth?: number,\r\n    gridWidth?: number\r\n): number {\r\n    if (!solutionWidth || !gridWidth) {\r\n        return 0;\r\n    }\r\n\r\n    const minOffset = -(DEFAULT_CONTAINER_OFFSET / gridWidth);\r\n    const maxOffset = Math.max(minOffset,\r\n        (gridWidth - solutionWidth - CONTAINER_LEFT_ADJUST) / gridWidth);\r\n    return getBoundValue(offsetPct, maxOffset, minOffset);\r\n}\r\n\r\nfunction getBoundedContainerOffsetPctY(\r\n    offsetPct: number,\r\n    solutionHeight?: number,\r\n    gridHeight?: number\r\n): number {\r\n    if (!solutionHeight || !gridHeight) {\r\n        return 0;\r\n    }\r\n\r\n    const minOffset = -(DEFAULT_CONTAINER_OFFSET / gridHeight);\r\n    const maxOffset = Math.max(minOffset,\r\n        (gridHeight - solutionHeight - CONTAINER_BOTTOM_ADJUST) / gridHeight);\r\n    return getBoundValue(offsetPct, maxOffset, minOffset);\r\n}\r\n\r\nfunction getContainerOffsetX(offsetPct: number, gridWidth?: number): number {\r\n    if (!gridWidth) {\r\n        return DEFAULT_CONTAINER_OFFSET;\r\n    }\r\n\r\n    return DEFAULT_CONTAINER_OFFSET + (offsetPct * gridWidth);\r\n}\r\n\r\nfunction getContainerOffsetY(offsetPct: number, gridHeight?: number): number {\r\n    if (!gridHeight) {\r\n        return DEFAULT_CONTAINER_OFFSET;\r\n    }\r\n\r\n    return DEFAULT_CONTAINER_OFFSET + TOP_MENU_HEIGHT + (offsetPct * gridHeight);\r\n}\r\n\r\nfunction getProperContainerSize(\r\n    width: number,\r\n    height: number,\r\n    offsetPctX: number,\r\n    offsetPctY: number,\r\n    gridWidth: number,\r\n    gridHeight: number\r\n): { width: number, height: number } {\r\n    const offsetX = getContainerOffsetX(offsetPctX, gridWidth);\r\n    const offsetY = getContainerOffsetY(offsetPctY, gridHeight);\r\n\r\n    // TODO: Find a better way to find the max sizes, if possible\r\n    const maxContainerWidth = gridWidth - offsetX - 8;\r\n    const maxContainerHeight = gridHeight - offsetY - 32;\r\n\r\n    return {\r\n        width: Math.max(Math.min(width, maxContainerWidth), MIN_CONTAINER_SIZE),\r\n        height: Math.max(Math.min(height, maxContainerHeight), MIN_CONTAINER_SIZE)\r\n    };\r\n}\r\n\r\nexport default function Solution(props: SolutionProps) {\r\n    // Sizes\r\n    const [ tileSizeIndex, setTileSizeIndex ] = useState(DEFAULT_TILE_SIZE_INDEX);\r\n    const [ containerWidth, setContainerWidth ] = useState(DEFAULT_SOLUTION_CONTAINER_SIZE);\r\n    const [ containerHeight, setContainerHeight ] = useState(DEFAULT_SOLUTION_CONTAINER_SIZE);\r\n    const [ mobileHeightPct, setMobileHeightPct ] = useState(DEFAULT_MOBILE_HEIGHT_PCT);\r\n\r\n    // Pointer position\r\n    const [ lastPointerX, setLastPointerX] = useState(0);\r\n    const [ lastPointerY, setLastPointerY] = useState(0);\r\n\r\n    // Grid offset\r\n    const [ isGridPointerDown, setIsGridPointerDown ] = useState(false);\r\n    const [ gridOffsetPctX, setGridOffsetPctX ] = useState(0);\r\n    const [ gridOffsetPctY, setGridOffsetPctY ] = useState(0);\r\n\r\n    // Container offset\r\n    const [ isContainerPointerDown, setIsContainerPointerDown ] = useState(false);\r\n    const [ containerOffsetPctX, setContainerOffsetPctX ] = useState(0);\r\n    const [ containerOffsetPctY, setContainerOffsetPctY ] = useState(0);\r\n\r\n    const { width, height, ref } = useResizeDetector({\r\n        refreshMode: \"throttle\",\r\n        refreshRate: 10\r\n    });\r\n\r\n    const tileSize = TILES_SIZES[tileSizeIndex] ?? DEFAULT_SOLUTION_TILE_SIZE;\r\n    const offset = props.grid.getCenterOffset(tileSize, width ?? 0, height ?? 0);\r\n    const solutionTopRef = useRef<HTMLElement>(null);\r\n    const isInMobileView = props.gridWidth !== undefined && props.gridWidth < GAME_MOBILE_WIDTH;\r\n\r\n    // Add draggable offset\r\n    offset.x += (gridOffsetPctX * (width ?? 0));\r\n    offset.y += (gridOffsetPctY * (height ?? 0));\r\n\r\n    const onResetLayout = () => {\r\n        setGridOffsetPctX(0);\r\n        setGridOffsetPctY(0);\r\n        setTileSizeIndex(DEFAULT_TILE_SIZE_INDEX);\r\n        setContainerWidth(DEFAULT_SOLUTION_CONTAINER_SIZE);\r\n        setContainerHeight(DEFAULT_SOLUTION_CONTAINER_SIZE);\r\n        setContainerOffsetPctX(0);\r\n        setContainerOffsetPctY(0);\r\n        setMobileHeightPct(DEFAULT_MOBILE_HEIGHT_PCT);\r\n    };\r\n\r\n    // Reset to default offset and zoom after we switch to a new level\r\n    useEffect(() => {\r\n        onResetLayout();\r\n    }, [ props.levelNumber ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Reset to default offset if the reset layout button was pressed\r\n    useEffect(() => {\r\n        if (props.shouldResetLayout) {\r\n            onResetLayout();\r\n        }\r\n    }, [ props.shouldResetLayout ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Make sure the solution is not offscreen when the viewport is resized\r\n    useEffect(() => {\r\n\r\n        // Not needed in mobile view\r\n        if (isInMobileView) {\r\n            return;\r\n        }\r\n\r\n        const offsetPctX = getBoundedContainerOffsetPctX(containerOffsetPctX, containerWidth,\r\n            props.gridWidth);\r\n        const offsetPctY = getBoundedContainerOffsetPctY(containerOffsetPctY, containerHeight,\r\n                props.gridHeight);\r\n\r\n        setContainerOffsetPctX(offsetPctX);\r\n        setContainerOffsetPctY(offsetPctY);\r\n\r\n        if (props.gridWidth && props.gridHeight) {\r\n            const size = getProperContainerSize(containerWidth, containerHeight, offsetPctX,\r\n                offsetPctY, props.gridWidth, props.gridHeight);\r\n\r\n            setContainerWidth(size.width);\r\n            setContainerHeight(size.height);\r\n        }\r\n    }, [ props.gridWidth, props.gridHeight ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Make sure the mobile solution is still visible after viewport height changes\r\n    useEffect(() => {\r\n        if (!props.appHeight) {\r\n            return;\r\n        }\r\n\r\n        let pct = getBoundValue(mobileHeightPct, MAX_MOBILE_HEIGHT_PCT,\r\n            MIN_MOBILE_HEIGHT / props.appHeight);\r\n        setMobileHeightPct(pct);\r\n    }, [ props.appHeight ]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    // Grid dragging handlers\r\n    const onGridPointerDown = (event: PointerEvent): void => {\r\n\r\n        // Do not start dragging if we clicked on the adjustment menu\r\n        if (isInElementById(event.target as HTMLElement, \"solution-adjust-menu\")) {\r\n            return;\r\n        }\r\n\r\n        setIsGridPointerDown(true);\r\n        setLastPointerX(event.clientX);\r\n        setLastPointerY(event.clientY);\r\n        ref.current && ref.current.setPointerCapture(event.pointerId);\r\n    };\r\n\r\n    const onGridPointerMove = (event: PointerEvent): void => {\r\n        // Do not process unless the pointer is pressed down\r\n        if (!isGridPointerDown) {\r\n            return;\r\n        }\r\n\r\n        // Set the offset\r\n        let nextOffsetPctX = gridOffsetPctX + ((event.clientX - lastPointerX) / (width || 1));\r\n        nextOffsetPctX = getBoundValue(nextOffsetPctX, MAX_GRID_DRAG_X_PCT, MIN_GRID_DRAG_X_PCT);\r\n\r\n        let nextOffsetPctY = gridOffsetPctY + ((event.clientY - lastPointerY) / (height || 1));\r\n        nextOffsetPctY = getBoundValue(nextOffsetPctY, MAX_GRID_DRAG_Y_PCT, MIN_GRID_DRAG_Y_PCT);\r\n\r\n        setGridOffsetPctX(nextOffsetPctX);\r\n        setGridOffsetPctY(nextOffsetPctY);\r\n\r\n        // Set last pointer coordinates\r\n        setLastPointerX(event.clientX);\r\n        setLastPointerY(event.clientY);\r\n    };\r\n\r\n    const onGridPointerUp = async (event: PointerEvent) => {\r\n        setIsGridPointerDown(false);\r\n        ref.current && ref.current.releasePointerCapture(event.pointerId);\r\n    };\r\n\r\n    // Solution container dragging handlers\r\n    const onContainerPointerDown = (event: PointerEvent): void => {\r\n\r\n        // Not needed in mobile view\r\n        if (isInMobileView) {\r\n            return;\r\n        }\r\n\r\n        setIsContainerPointerDown(true);\r\n        setLastPointerX(event.clientX);\r\n        setLastPointerY(event.clientY);\r\n        solutionTopRef.current && solutionTopRef.current.setPointerCapture(event.pointerId);\r\n    };\r\n\r\n    const onContainerPointerMove = (event: PointerEvent): void => {\r\n        // Do not process unless the pointer is pressed down\r\n        if (!isContainerPointerDown || isInMobileView) {\r\n            return;\r\n        }\r\n\r\n        // Set the offset\r\n\r\n        // Reverse the x delta since we apply the offset to the right, not left\r\n        let nextOffsetPctX = containerOffsetPctX -\r\n            ((event.clientX - lastPointerX) / (props.gridWidth || 1));\r\n        nextOffsetPctX = getBoundedContainerOffsetPctX(nextOffsetPctX, containerWidth,\r\n            props.gridWidth);\r\n\r\n        let nextOffsetPctY = containerOffsetPctY +\r\n            ((event.clientY - lastPointerY) / (props.gridHeight || 1));\r\n        nextOffsetPctY = getBoundedContainerOffsetPctY(nextOffsetPctY, containerHeight,\r\n            props.gridHeight);\r\n\r\n        setContainerOffsetPctX(nextOffsetPctX);\r\n        setContainerOffsetPctY(nextOffsetPctY);\r\n\r\n        // Set last pointer coordinates\r\n        setLastPointerX(event.clientX);\r\n        setLastPointerY(event.clientY);\r\n    };\r\n\r\n    const onContainerPointerUp = async (event: PointerEvent) => {\r\n        setIsContainerPointerDown(false);\r\n        solutionTopRef.current && solutionTopRef.current.releasePointerCapture(event.pointerId);\r\n    };\r\n\r\n    const canAdjust = !props.gameOver && !props.isMenuOpen;\r\n    const canZoomIn = tileSizeIndex < TILES_SIZES.length - 1;\r\n    const canZoomOut = tileSizeIndex > 0;\r\n\r\n    const zoomIn = (): void => {\r\n        if (canZoomIn && canAdjust) {\r\n            setTileSizeIndex(tileSizeIndex + 1);\r\n        }\r\n    };\r\n\r\n    const zoomOut = (): void => {\r\n        if (canZoomOut && canAdjust) {\r\n            setTileSizeIndex(tileSizeIndex - 1);\r\n        }\r\n    };\r\n\r\n    const onResize = (event: SyntheticEvent, data: ResizeCallbackData) => {\r\n        let newWidth = data.size.width;\r\n        let newHeight = data.size.height;\r\n\r\n        if (props.gridWidth && props.gridHeight) {\r\n            const size = getProperContainerSize(newWidth, newHeight,\r\n                containerOffsetPctX, containerOffsetPctY, props.gridWidth, props.gridHeight);\r\n\r\n            newWidth = size.width;\r\n            newHeight = size.height;\r\n        }\r\n\r\n        setContainerWidth(newWidth);\r\n        setContainerHeight(newHeight);\r\n    };\r\n\r\n    const onMobileResize = (event: SyntheticEvent, data: ResizeCallbackData) => {\r\n        if (props.appHeight) {\r\n            let pct = data.size.height / props.appHeight;\r\n            pct = getBoundValue(pct, MAX_MOBILE_HEIGHT_PCT, MIN_MOBILE_HEIGHT / props.appHeight);\r\n            setMobileHeightPct(pct);\r\n        }\r\n    };\r\n\r\n    // Solution grid props\r\n    const solutionProps: Record<string, any> = {\r\n        className: \"solution\",\r\n        ref,\r\n        onPointerDown: onGridPointerDown,\r\n        onPointerUp: onGridPointerUp\r\n    };\r\n\r\n    if (!isInMobileView) {\r\n        solutionProps.style = {\r\n            height: `${containerHeight}px`,\r\n            width: `${containerWidth}px`\r\n        };\r\n    }\r\n\r\n    if (isGridPointerDown) {\r\n        solutionProps.onPointerMove = onGridPointerMove;\r\n    }\r\n\r\n    // Solution top bar props\r\n    let topBarClassName = \"solution-target-text\";\r\n    topBarClassName += !isInMobileView ? \" solution-draggable\" : \"\";\r\n    const topBarProps: Record<string, any> = {\r\n        className: topBarClassName,\r\n        ref: solutionTopRef,\r\n        onPointerDown: onContainerPointerDown,\r\n        onPointerUp: onContainerPointerUp\r\n    };\r\n\r\n    if (isContainerPointerDown) {\r\n        topBarProps.onPointerMove = onContainerPointerMove;\r\n    }\r\n\r\n    // Container style\r\n    const containerStyle: Record<string, any> = {};\r\n    const mHeight = props.appHeight ? props.appHeight * mobileHeightPct : MIN_MOBILE_HEIGHT;\r\n    if (!isInMobileView) {\r\n        containerStyle.right = getContainerOffsetX(containerOffsetPctX, props.gridWidth);\r\n        containerStyle.top = getContainerOffsetY(containerOffsetPctY, props.gridHeight);\r\n    } else {\r\n        containerStyle.height = `${mHeight}px`;\r\n    }\r\n\r\n    // Solution grid\r\n    const solutionTiles = props.grid.renderSolution();\r\n\r\n    // Build the solution element\r\n    let solutionElement = (\r\n        <div className=\"solution-container\" style={containerStyle}>\r\n            <span {...topBarProps}>Target</span>\r\n            <div {...solutionProps}>\r\n                <SolutionAdjustMenu\r\n                    canZoomIn={canZoomIn}\r\n                    canZoomOut={canZoomOut}\r\n                    zoomInHandler={zoomIn}\r\n                    zoomOutHandler={zoomOut} />\r\n                {solutionTiles}\r\n                <SolutionPlayerCursor row={props.playerRow} col={props.playerCol} />\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    // Add resizable\r\n    if (!isInMobileView) {\r\n        solutionElement = (\r\n            <Resizable height={containerHeight} width={containerWidth} onResize={onResize}\r\n                minConstraints={[MIN_CONTAINER_SIZE, MIN_CONTAINER_SIZE]}\r\n                maxConstraints={[MAX_CONTAINER_SIZE, MAX_CONTAINER_SIZE]}\r\n                resizeHandles={[ \"sw\" ]}>\r\n                {solutionElement}\r\n            </Resizable>\r\n        );\r\n    } else {\r\n        const maxSize = props.appHeight ?\r\n            Math.max(props.appHeight * MAX_MOBILE_HEIGHT_PCT, MIN_MOBILE_HEIGHT) :\r\n            MAX_CONTAINER_SIZE;\r\n        solutionElement = (\r\n            <Resizable axis=\"y\" width={0} height={mHeight} onResize={onMobileResize}\r\n                minConstraints={[0, MIN_MOBILE_HEIGHT]}\r\n                maxConstraints={[Infinity, maxSize]}\r\n                resizeHandles={[ \"n\" ]}>\r\n                {solutionElement}\r\n            </Resizable>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <GridOffsetContext.Provider value={offset}>\r\n            <TileSizeContext.Provider value={tileSize}>\r\n                {solutionElement}\r\n            </TileSizeContext.Provider>\r\n        </GridOffsetContext.Provider>\r\n    );\r\n}\r\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n    faSync,\r\n    faUndoAlt,\r\n    faRedoAlt,\r\n    faSearchPlus,\r\n    faSearchMinus\r\n} from '@fortawesome/free-solid-svg-icons';\r\nimport \"./game-adjust-menu.scss\";\r\n\r\ninterface GameAdjustMenuProps {\r\n    canUndo: boolean,\r\n    canRedo: boolean,\r\n    canZoomIn: boolean,\r\n    canZoomOut: boolean,\r\n    undoHandler: () => void,\r\n    redoHandler: () => void,\r\n    restartHandler: () => void,\r\n    zoomInHandler: () => void,\r\n    zoomOutHandler: () => void\r\n}\r\n\r\nexport default function GameAdjustMenu(props: GameAdjustMenuProps) {\r\n    const undoClass = `adjust-btn ${!props.canUndo ? \" adjust-disabled\" : \"\"}`;\r\n    const redoClass = `adjust-btn ${!props.canRedo ? \" adjust-disabled\" : \"\"}`;\r\n    const zoomInClass = `adjust-btn ${!props.canZoomIn ? \" adjust-disabled\" : \"\"}`;\r\n    const zoomOutClass = `adjust-btn ${!props.canZoomOut ? \" adjust-disabled\" : \"\"}`;\r\n\r\n    return (\r\n        <div className=\"adjust-menu game-adjust-menu\">\r\n            <div className=\"adjust-btn\">\r\n                <button tabIndex={0} onClick={props.restartHandler} aria-label=\"Restart game\">\r\n                    <FontAwesomeIcon icon={faSync} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Restart</div>\r\n            </div>\r\n\r\n            <div className=\"adjust-separator\"></div>\r\n\r\n            <div className={undoClass}>\r\n                <button tabIndex={0} onClick={props.undoHandler} aria-label=\"Undo\">\r\n                    <FontAwesomeIcon icon={faUndoAlt} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Undo</div>\r\n            </div>\r\n\r\n            <div className={redoClass}>\r\n                <button tabIndex={0} onClick={props.redoHandler} aria-label=\"Redo\">\r\n                    <FontAwesomeIcon icon={faRedoAlt} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Redo</div>\r\n            </div>\r\n\r\n            <div className=\"adjust-separator\"></div>\r\n\r\n            <div className={zoomInClass}>\r\n                <button tabIndex={0} onClick={props.zoomInHandler} aria-label=\"Zoom in\">\r\n                    <FontAwesomeIcon icon={faSearchPlus} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Zoom In</div>\r\n            </div>\r\n\r\n            <div className={zoomOutClass}>\r\n                <button tabIndex={0} onClick={props.zoomOutHandler} aria-label=\"Zoom out\">\r\n                    <FontAwesomeIcon icon={faSearchMinus} />\r\n                </button>\r\n\r\n                <div className=\"adjust-tooltip\">Zoom Out</div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { useState } from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\r\nimport \"./settings.scss\";\r\n\r\ninterface SettingsProps {\r\n    visible: boolean,\r\n    onEraseData?: () => void,\r\n    onGoBack: () => void\r\n};\r\n\r\nexport default function Settings(props: SettingsProps) {\r\n    const [ showEraseConfirm, setShowEraseConfirm ] = useState(false);\r\n\r\n    const className = `settings ${props.visible ? \"settings-enabled\" : \"\"}`;\r\n\r\n    const backOnClick = () => {\r\n        setShowEraseConfirm(false);\r\n        props.onGoBack();\r\n    }\r\n\r\n    const onEraseConfirm = () => {\r\n        props.onEraseData && props.onEraseData();\r\n        setShowEraseConfirm(false);\r\n    };\r\n\r\n    let eraseElement = null;\r\n    if (props.onEraseData) {\r\n        let eraseConfirm = null;\r\n        if (showEraseConfirm) {\r\n            eraseConfirm = (\r\n                <div>\r\n                    <p>\r\n                        {\"Are you sure you want to continue. If yes, your save data will be \"}\r\n                        <strong>permanently</strong> erased.\r\n                    </p>\r\n                    <button className=\"erase-confirm-btn erase-continue\" onClick={onEraseConfirm}>\r\n                        Continue\r\n                    </button>\r\n                    <button className=\"erase-confirm-btn erase-cancel\"\r\n                        onClick={setShowEraseConfirm.bind(null, false)}>\r\n                        Cancel\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        eraseElement = (\r\n            <div className=\"settings-erase\">\r\n                <h2>Save Data</h2>\r\n                <button onClick={setShowEraseConfirm.bind(null, true)}>Erase save data?</button>\r\n                {eraseConfirm}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={className}>\r\n            <header className=\"top-bar settings-top-bar\">\r\n                <button className=\"top-bar-text back-btn\" aria-label=\"Go back\"\r\n                    onClick={backOnClick}>\r\n                    <FontAwesomeIcon icon={faArrowLeft} />\r\n                </button>\r\n                <div className=\"level-select-title\">\r\n                    <h1 className=\"top-bar-text\">Settings</h1>\r\n                </div>\r\n                <div className=\"clearfix\"></div>\r\n            </header>\r\n\r\n            <main className=\"settings-main\">\r\n                <section className=\"settings-section\">\r\n                    {eraseElement}\r\n                </section>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\r\nimport \"./instructions.scss\";\r\n\r\ninterface InstructionsProps {\r\n    visible: boolean,\r\n    onGoBack: () => void\r\n};\r\n\r\nexport default function Instructions(props: InstructionsProps) {\r\n    const className = `instructions ${props.visible ? \"instructions-enabled\" : \"\"}`;\r\n\r\n    // TODO: Make each section collapsible\r\n    return (\r\n        <div className={className}>\r\n            <header className=\"top-bar instructions-top-bar\">\r\n                <button className=\"top-bar-text back-btn\" aria-label=\"Go back\"\r\n                    onClick={props.onGoBack}>\r\n                    <FontAwesomeIcon icon={faArrowLeft} />\r\n                </button>\r\n                <div className=\"level-select-title\">\r\n                    <h1 className=\"top-bar-text\">How to Play</h1>\r\n                </div>\r\n                <div className=\"clearfix\"></div>\r\n            </header>\r\n\r\n            <main className=\"instructions-main\">\r\n                <section className=\"instructions-section\">\r\n                    <h2>Objective</h2>\r\n                    <p>\r\n                        The goal for any level in <em> Color Coords </em> is to color the puzzle\r\n                        grid so that it matches the grid shown in the target window. In order to\r\n                        color the puzzle grid, you must move of the\r\n                        <em className=\"highlight\"> player piece </em> across the grid. As you move\r\n                        the player piece across the grid, you may land on tiles that contain an\r\n                        <em className=\"highlight\"> item</em>. Find the solution to each puzzle\r\n                        by maneuvering the player piece and utilizing any items placed on the grid.\r\n                    </p>\r\n\r\n                    <h2>Gameplay</h2>\r\n\r\n                    <h3>Player Piece</h3>\r\n                    <p>\r\n                        The <em> player piece </em> moves across the board, one tile at a time. It\r\n                        can move either <em className=\"highlight\"> up, down, left or right</em>.\r\n                        At the start of the game, the piece starts in an\r\n                        <em className=\"highlight\"> uncolored state</em>. While in this state,\r\n                        the player piece does not affect the puzzle grid in any way. With the help\r\n                        of items, you can change the state of the player piece to color the grid.\r\n                    </p>\r\n\r\n                    <h3>Items</h3>\r\n                    <p>Items are used to alter the puzzle grid and/or the player piece.</p>\r\n\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Type</th>\r\n                                    <th>Description</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr>\r\n                                    <td>Color Swatch</td>\r\n                                    <td>\r\n                                        This item changes the color of the player piece to the same\r\n                                        color as the swatch. While the player piece is colored,\r\n                                        <em className=\"highlight\"> it will color any tile that it\r\n                                        lands on</em>.\r\n                                    </td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Dark Swatch</td>\r\n                                    <td>\r\n                                        This item turns the player piece black. While the player piece\r\n                                        is in this state, it will\r\n                                        <em className=\"highlight\"> erase color </em>\r\n                                        from any grid tile it lands on.\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <h3>Tiles</h3>\r\n                    <p>\r\n                        The puzzle grid is made up of <em> tiles</em>. There are several different\r\n                        types of tiles, each with its own properties.\r\n                    </p>\r\n\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Type</th>\r\n                                    <th>Description</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr>\r\n                                    <td>Default Tile</td>\r\n                                    <td>\r\n                                        Default tiles start off white and\r\n                                        <em className=\"highlight\"> can be colored </em> by the\r\n                                        player piece if they happen to land on the tile while in a\r\n                                        colored state.\r\n                                    </td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Dark Tile</td>\r\n                                    <td>\r\n                                        Dark tiles are black and <em className=\"highlight\"> cannot\r\n                                        be changed to a different color </em> even if the player\r\n                                        piece lands on it while in a colored state.\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <h2>Stars</h2>\r\n                    <p>\r\n                        After completing a level, you will be rewarded with up to three stars. You\r\n                        will earn at least one star for each level completed. To earn two or three\r\n                        stars on a level, you must complete the level within a certain amount of\r\n                        moves. <em className=\"highlight\"> In general, the fewer moves you use to\r\n                        complete a level, the more stars you will receive. </em> Check the\r\n                        <em> level select </em> screen for the required number of moves required to\r\n                        each additional stars for each level.\r\n                    </p>\r\n\r\n                    <h2>Controls</h2>\r\n                    <div className=\"table-container\">\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Action</th>\r\n                                    <th>Keyboard</th>\r\n                                    <th>Mouse</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr>\r\n                                    <td>Player Piece Movement</td>\r\n                                    <td>Arrow keys</td>\r\n                                    <td>Left click on tile</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Toggle Target</td>\r\n                                    <td>Q (hold)</td>\r\n                                    <td>-</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Undo</td>\r\n                                    <td>Z</td>\r\n                                    <td>-</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Redo</td>\r\n                                    <td>Y</td>\r\n                                    <td>-</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Restart</td>\r\n                                    <td>R</td>\r\n                                    <td>-</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Toggle Game Menu</td>\r\n                                    <td>Escape</td>\r\n                                    <td>-</td>\r\n                                </tr>\r\n                                <tr>\r\n                                    <td>Reposition Grid/Target</td>\r\n                                    <td>-</td>\r\n                                    <td>Left click (drag)</td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                    <h2>Miscellaneous</h2>\r\n                    <ul>\r\n                        <li>\r\n                            If you want to adjust the layout of the game, you can\r\n                            <em className=\"highlight\"> reposition </em> the puzzle grid and/or the\r\n                            target window by dragging the screen with your cursor. For the target,\r\n                            you can reposition both the target window, as well as the target grid\r\n                            within the window. You can also\r\n                            <em className=\"highlight\"> zoom in or out </em> using the zoom buttons\r\n                            in the quick menus. If you want to reset back to the default layout, go\r\n                            into the game menu and select\r\n                            <em className=\"highlight\"> Reset Layout</em>.\r\n                        </li>\r\n                    </ul>\r\n                </section>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport \"./game-tutorial.scss\";\r\nimport type { LevelInstruction } from \"../../services/levels\";\r\n\r\ninterface GameTutorialProps {\r\n    levelInstructions: LevelInstruction[],\r\n    isMenuOpen: boolean,\r\n    onComplete: () => void\r\n}\r\n\r\nexport default function GameTutorial(props: GameTutorialProps) {\r\n    const [ currentInstruction, setCurrentInstruction ] = useState(0);\r\n\r\n    useEffect(() => {\r\n        if (currentInstruction >= props.levelInstructions.length) {\r\n            props.onComplete();\r\n        }\r\n    }, [currentInstruction]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const onNext = () => {\r\n        if (props.isMenuOpen) {\r\n            return;\r\n        }\r\n\r\n        setCurrentInstruction(currentInstruction + 1);\r\n    };\r\n\r\n    const onPrevious = () => {\r\n        if (props.isMenuOpen) {\r\n            return;\r\n        }\r\n\r\n        setCurrentInstruction(currentInstruction - 1);\r\n    };\r\n\r\n    const onSkip = () => {\r\n        if (props.isMenuOpen) {\r\n            return;\r\n        }\r\n\r\n        setCurrentInstruction(props.levelInstructions.length);\r\n    };\r\n\r\n    if (currentInstruction >= props.levelInstructions.length || currentInstruction < 0) {\r\n        return null;\r\n    }\r\n\r\n    const child = props.levelInstructions[currentInstruction].element;\r\n    const canGoPrevious = currentInstruction > 0;\r\n    const canSkip = currentInstruction < props.levelInstructions.length - 1;\r\n\r\n    const prevBtn = canGoPrevious ?\r\n        (<button className=\"game-tutorial-btn left-btn\" onClick={onPrevious}>Previous</button>) :\r\n        null;\r\n    const skipBtn = canSkip ?\r\n        (<button className=\"game-tutorial-btn right-btn skip-btn\" onClick={onSkip}>Skip</button>) :\r\n        null;\r\n    const nextText = currentInstruction < props.levelInstructions.length - 1 ? \"Next\" : \"Finish\";\r\n\r\n    return (\r\n        <div className=\"game-tutorial\">\r\n            {child}\r\n            <div className=\"game-tutorial-btn-container\">\r\n                {prevBtn}\r\n                {skipBtn}\r\n                <button className=\"game-tutorial-btn right-btn\" onClick={onNext}>{nextText}</button>\r\n                <div className=\"clearfix\"></div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","import { Color, PlayerMovementType, DIR_OFFSET } from \"../services/constants\";\r\nimport type Grid from \"./grid\";\r\nimport type GridCell from \"./grid-cell\";\r\nimport type { Direction } from \"../services/constants\";\r\n\r\ninterface PlayerMovement {\r\n    currentDirection: (Direction | null),\r\n    prevDirection: (Direction | null)\r\n}\r\n\r\ninterface PlayerMovementResult {\r\n    moved: boolean,\r\n    newRow: number,\r\n    newCol: number,\r\n    newColor: Color,\r\n    directionMoved?: Direction,\r\n    gridCellMovedTo?: GridCell,\r\n    movementType?: PlayerMovementType\r\n}\r\n\r\nexport type { PlayerMovement };\r\n\r\nexport default class Player {\r\n    row: number;\r\n    col: number;\r\n    grid: Grid;\r\n    color: Color;\r\n\r\n    constructor(row: number, col: number, grid: Grid, color?: Color) {\r\n        this.row = row;\r\n        this.col = col;\r\n        this.grid = grid;\r\n        this.color = color ?? Color.DEFAULT;\r\n    }\r\n\r\n    move(movement: PlayerMovement): PlayerMovementResult {\r\n        let rowOffset = 0;\r\n        let colOffset = 0;\r\n        const currCell = this.grid.getCellAt(this.row, this.col);\r\n        let directionMoved;\r\n\r\n        // Determine where to move\r\n        if (movement.currentDirection) {\r\n            const offset = DIR_OFFSET[movement.currentDirection];\r\n            rowOffset = offset.rowOffset;\r\n            colOffset = offset.colOffset;\r\n            directionMoved = movement.currentDirection;\r\n        } else if (currCell?.ice && movement.prevDirection) {\r\n            const offset = DIR_OFFSET[movement.prevDirection];\r\n            rowOffset = offset.rowOffset;\r\n            colOffset = offset.colOffset;\r\n            directionMoved = movement.prevDirection;\r\n        }\r\n\r\n        // Determine final grid tile\r\n        if ((rowOffset !== 0 || colOffset !== 0) && directionMoved) {\r\n            const nextRow = this.row + rowOffset;\r\n            const nextCol = this.col + colOffset;\r\n            const gridCell = this.grid.getCellAt(nextRow, nextCol);\r\n\r\n            if (gridCell) {\r\n                this.row = nextRow;\r\n                this.col = nextCol;\r\n\r\n                // Change the player color if possible\r\n                let nextPlayerColor;\r\n                if (gridCell.item && (nextPlayerColor = gridCell.item.updatePlayerColor())) {\r\n                    this.color = nextPlayerColor;\r\n                }\r\n\r\n                let moveType = PlayerMovementType.DEFAULT;\r\n                if (currCell?.ice && gridCell.ice && !movement.currentDirection) {\r\n                    moveType = PlayerMovementType.ON_ICE;\r\n                } else if (gridCell.ice) {\r\n                    moveType = PlayerMovementType.TO_ICE;\r\n                } else if (currCell?.ice && movement.prevDirection) {\r\n                    moveType = PlayerMovementType.FROM_ICE;\r\n                }\r\n\r\n                return {\r\n                    moved: true,\r\n                    newRow: this.row,\r\n                    newCol: this.col,\r\n                    newColor: this.color,\r\n                    directionMoved: directionMoved,\r\n                    gridCellMovedTo: gridCell,\r\n                    movementType: moveType\r\n                };\r\n            }\r\n        }\r\n\r\n        return {\r\n            moved: false,\r\n            newRow: this.row,\r\n            newCol: this.col,\r\n            newColor: this.color\r\n        };\r\n    }\r\n}\r\n","import type Grid from \"./grid\";\r\nimport type { Color } from \"../services/constants\";\r\n\r\nconst HISTORY_LIMIT = 60;\r\n\r\ninterface GameHistoryState {\r\n    grid: Grid;\r\n    playerRow: number;\r\n    playerCol: number;\r\n    playerColor: Color;\r\n};\r\n\r\nclass GameHistoryNode {\r\n    grid: Grid;\r\n    playerRow: number;\r\n    playerCol: number;\r\n    playerColor: Color;\r\n    previous: (GameHistoryNode | null) = null;\r\n    next: (GameHistoryNode | null) = null;\r\n\r\n    constructor (grid: Grid, playerRow: number, playerCol: number, playerColor: Color) {\r\n        this.grid = grid;\r\n        this.playerRow = playerRow;\r\n        this.playerCol = playerCol;\r\n        this.playerColor = playerColor;\r\n    }\r\n};\r\n\r\nclass GameHistoryDoublyLinkedList {\r\n    private start: (GameHistoryNode | null) = null;\r\n    private end: (GameHistoryNode | null) = null;\r\n    private _size: number = 0;\r\n\r\n    get size(): number {\r\n        return this._size;\r\n    }\r\n\r\n    push(grid: Grid, playerRow: number, playerCol: number, playerColor: Color): GameHistoryNode {\r\n        const node = new GameHistoryNode(grid, playerRow, playerCol, playerColor);\r\n        this._size += 1;\r\n\r\n        // If there is no end node, then there is no node in the list\r\n        if (!this.end) {\r\n            this.start = this.end = node;\r\n        }\r\n\r\n        // Otherwise, just add normally\r\n        else {\r\n            node.previous = this.end;\r\n            this.end.next = node;\r\n            this.end = node;\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    pop(): (GameHistoryNode | null) {\r\n\r\n        // No nodes in the list\r\n        if (!this.end) {\r\n            return null\r\n        }\r\n\r\n        // Only one node in the list\r\n        if (this.start === this.end) {\r\n            const node = this.end;\r\n            this.start = this.end = null;\r\n            this._size -= 1;\r\n\r\n            return node;\r\n        }\r\n\r\n        // Otherwise, pop the end and set the second last end node to be the new end node\r\n        const node = this.end;\r\n        this.end = this.end.previous; // Move second last end node to end\r\n\r\n        this.end && (this.end.next = null); // Remove reference to popped node\r\n        this._size -= 1;\r\n\r\n        return node;\r\n    }\r\n\r\n    unshift(grid: Grid, playerRow: number, playerCol: number, playerColor: Color): GameHistoryNode {\r\n        const node = new GameHistoryNode(grid, playerRow, playerCol, playerColor);\r\n        this._size += 1;\r\n\r\n        // If there is no start node, then there is no node in the list\r\n        if (!this.start) {\r\n            this.start = this.end = node;\r\n        }\r\n\r\n        // Otherwise, just add normally\r\n        else {\r\n            node.next = this.start;\r\n            this.start.previous = node;\r\n            this.start = node;\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    shift(): (GameHistoryNode | null) {\r\n\r\n        // No nodes in the list\r\n        if (!this.start) {\r\n            return null\r\n        }\r\n\r\n        // Only one node in the list\r\n        if (this.start === this.end) {\r\n            const node = this.start;\r\n            this.start = this.end = null;\r\n            this._size -= 1;\r\n\r\n            return node;\r\n        }\r\n\r\n        // Otherwise, shift the first element and set the second node to be the new start node\r\n        const node = this.start;\r\n        this.start = this.start.next; // Move second node to start\r\n\r\n        this.start && (this.start.previous = null); // Remove reference to shifted node\r\n        this._size -= 1;\r\n\r\n        return node;\r\n    }\r\n\r\n    clear(): void {\r\n        this.start = null;\r\n        this.end = null;\r\n        this._size = 0;\r\n    }\r\n}\r\n\r\nexport default class GameHistory {\r\n    private undoHistory: GameHistoryDoublyLinkedList;\r\n    private redoHistory: GameHistoryDoublyLinkedList;\r\n    private currentState: GameHistoryState;\r\n\r\n    constructor(grid: Grid, playerRow: number, playerCol: number, playerColor: Color) {\r\n        this.undoHistory = new GameHistoryDoublyLinkedList();\r\n        this.redoHistory = new GameHistoryDoublyLinkedList();\r\n        this.currentState = { grid, playerRow, playerCol, playerColor };\r\n    }\r\n\r\n    get size(): number {\r\n        return this.undoHistory.size + this.redoHistory.size;\r\n    }\r\n\r\n    push(grid: Grid, playerRow: number, playerCol: number, playerColor: Color): void {\r\n        // Push current state onto undo history\r\n        this.undoHistory.push(\r\n            this.currentState.grid,\r\n            this.currentState.playerRow,\r\n            this.currentState.playerCol,\r\n            this.currentState.playerColor\r\n        );\r\n\r\n        // Replace current state with new state\r\n        this.currentState.grid = grid;\r\n        this.currentState.playerRow = playerRow;\r\n        this.currentState.playerCol = playerCol;\r\n        this.currentState.playerColor = playerColor;\r\n\r\n        // Clear any states in the redo history if we add a new state\r\n        this.redoHistory.clear();\r\n\r\n        // If we're over the limit, shift states from the beginning\r\n        while (this.size > HISTORY_LIMIT) {\r\n            this.undoHistory.shift();\r\n        }\r\n    }\r\n\r\n    undo(): (GameHistoryState | null) {\r\n        if (!this.canUndo()) {\r\n            return null;\r\n        }\r\n\r\n        // Otherwise pop from undo history\r\n        const undoNode = this.undoHistory.pop();\r\n\r\n        // Push current state onto redo history\r\n        this.redoHistory.push(\r\n            this.currentState.grid,\r\n            this.currentState.playerRow,\r\n            this.currentState.playerCol,\r\n            this.currentState.playerColor\r\n        );\r\n\r\n        // Update current state and return\r\n        if (undoNode) {\r\n            this.currentState.grid = undoNode.grid;\r\n            this.currentState.playerRow = undoNode.playerRow;\r\n            this.currentState.playerCol = undoNode.playerCol;\r\n            this.currentState.playerColor = undoNode.playerColor;\r\n\r\n            return {\r\n                grid: undoNode.grid,\r\n                playerRow: undoNode.playerRow,\r\n                playerCol: undoNode.playerCol,\r\n                playerColor: undoNode.playerColor,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    redo(): (GameHistoryState | null) {\r\n        if (!this.canRedo()) {\r\n            return null;\r\n        }\r\n\r\n        // Otherwise pop from redo history\r\n        const redoNode = this.redoHistory.pop();\r\n\r\n        // Push current state onto undo history\r\n        this.undoHistory.push(\r\n            this.currentState.grid,\r\n            this.currentState.playerRow,\r\n            this.currentState.playerCol,\r\n            this.currentState.playerColor\r\n        );\r\n\r\n        if (redoNode) {\r\n            this.currentState.grid = redoNode.grid;\r\n            this.currentState.playerRow = redoNode.playerRow;\r\n            this.currentState.playerCol = redoNode.playerCol;\r\n            this.currentState.playerColor = redoNode.playerColor;\r\n\r\n            return {\r\n                grid: redoNode.grid,\r\n                playerRow: redoNode.playerRow,\r\n                playerCol: redoNode.playerCol,\r\n                playerColor: redoNode.playerColor,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    canUndo(): boolean {\r\n        return this.undoHistory.size > 0;\r\n    }\r\n\r\n    canRedo(): boolean {\r\n        return this.redoHistory.size > 0;\r\n    }\r\n}\r\n","import { AnimationType, PlayerMovementType } from \"../services/constants\";\r\nimport type { Color } from \"../services/constants\";\r\n\r\nexport default abstract class GridAnimationFrame {\r\n    row: number;\r\n    col: number;\r\n    animationType: AnimationType;\r\n    color: Color;\r\n    movementType?: PlayerMovementType;\r\n    isStart?: boolean;\r\n\r\n    constructor(\r\n        row: number,\r\n        col: number,\r\n        animationType: AnimationType,\r\n        color: Color,\r\n        movementType?: PlayerMovementType,\r\n        isStart?: boolean // Set to true if this frame is the start of a chain of moves\r\n    ) {\r\n        this.row = row;\r\n        this.col = col;\r\n        this.animationType = animationType;\r\n        this.color = color;\r\n        this.movementType = movementType;\r\n        this.isStart = isStart;\r\n    }\r\n\r\n    isPlayerAnimation(): boolean {\r\n        return this.animationType === AnimationType.PLAYER;\r\n    }\r\n\r\n    isTileAnimation(): boolean {\r\n        return this.animationType === AnimationType.TILE;\r\n    }\r\n}\r\n","import GridAnimationFrame from \"./grid-animation-frame\";\r\nimport { AnimationType, PlayerMovementType } from \"../services/constants\";\r\nimport type { Color } from \"../services/constants\";\r\n\r\nexport default class PlayerAnimationFrame extends GridAnimationFrame {\r\n    constructor(\r\n        row: number,\r\n        col: number,\r\n        color: Color,\r\n        movementType?: PlayerMovementType,\r\n        isStart?: boolean\r\n    ) {\r\n        super(row, col, AnimationType.PLAYER, color, movementType, isStart);\r\n    }\r\n}\r\n","import GridAnimationFrame from \"./grid-animation-frame\";\r\nimport { AnimationType } from \"../services/constants\";\r\nimport type { Color } from \"../services/constants\";\r\n\r\nexport default class TileAnimationFrame extends GridAnimationFrame {\r\n    constructor(row: number, col: number, color: Color) {\r\n        super(row, col, AnimationType.TILE, color);\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport { Queue } from '@datastructures-js/queue';\r\nimport { cloneDeep } from \"lodash\";\r\nimport produce from \"immer\";\r\nimport GridComponent from \"../grid\";\r\nimport GameHUD from \"../game-hud\";\r\nimport GameComplete from \"../game-complete\";\r\nimport Solution from \"../solution\";\r\nimport GameAdjustMenu from \"../game-adjust-menu\";\r\nimport Settings from \"../settings\";\r\nimport Instructions from \"../instructions\";\r\nimport GameTutorial from \"../game-tutorial\";\r\nimport Player from \"../../classes/player\";\r\nimport Grid from \"../../classes/grid\";\r\nimport GameHistory from \"../../classes/game-history\";\r\nimport PlayerAnimationFrame from \"../../classes/player-animation-frame\";\r\nimport TileAnimationFrame from \"../../classes/tile-animation-frame\";\r\nimport { sleep } from \"../../services/util\";\r\nimport { TileSizeContext } from \"../../services/context\";\r\nimport {\r\n    Color,\r\n    Direction,\r\n    TILES_SIZES,\r\n    DEFAULT_TILE_SIZE,\r\n    PlayerMovementType\r\n} from \"../../services/constants\";\r\nimport \"./game.scss\";\r\n\r\nimport type GridAnimationFrame from \"../../classes/grid-animation-frame\";\r\nimport type { KeyboardEvent } from \"react\";\r\nimport type { GridCellConfig } from \"../../classes/grid\";\r\nimport type { PlayerMovement } from \"../../classes/player\";\r\nimport type { LevelInstruction } from \"../../services/levels\";\r\n\r\ninterface GameProps {\r\n    gridConfig: GridCellConfig[][],\r\n    playerRow: number,\r\n    playerCol: number,\r\n    levelNumber: number, // 1-indexed\r\n    levelName: string,\r\n    levelInstructions?: LevelInstruction[],\r\n    appHeight?: number,\r\n    completedBefore: boolean,\r\n    handleStarUpdate: (levelNumber: number, movesTaken: number) => number,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number\r\n};\r\n\r\ninterface GameState {\r\n    grid: Grid,\r\n    playerRow: number,\r\n    playerCol: number,\r\n    playerColor: Color,\r\n    showSolution: boolean,\r\n    movesTaken: number,\r\n    gameStarted: boolean,\r\n    gameOver: boolean,\r\n    gameWon: boolean,\r\n    starsWon: number,\r\n    isPlayerMoving: boolean,\r\n    isMenuOpen: boolean,\r\n    areSettingsOpened: boolean,\r\n    areInstructionsOpened: boolean,\r\n    shouldCancelTilePress: boolean,\r\n    shouldResetLayout: boolean,\r\n    showTutorial: boolean,\r\n    tileSizeIndex: number,\r\n    gridWidth?: number,\r\n    gridHeight?: number,\r\n    playerMovementType?: PlayerMovementType\r\n};\r\n\r\ninterface MoveCount {\r\n    count: number,\r\n    [Direction.UP]: number,\r\n    [Direction.DOWN]: number,\r\n    [Direction.LEFT]: number,\r\n    [Direction.RIGHT]: number\r\n};\r\n\r\nconst DEFAULT_TILE_SIZE_INDEX = 6;\r\n\r\nexport default class Game extends React.Component<GameProps, GameState> {\r\n    movementKeyFnMap: Record<string, Function>;\r\n    utilKeyFnMap: Record<string, Function>;\r\n    keyPressFlagMap: Record<string, boolean>;\r\n    gridAnimationQueue: Queue<GridAnimationFrame>;\r\n    gameContainerRef: React.RefObject<HTMLDivElement>;\r\n    gameHistory: GameHistory;\r\n\r\n    constructor(props: GameProps) {\r\n        super(props);\r\n        this.state = {\r\n            grid: new Grid(props.gridConfig),\r\n            playerRow: props.playerRow,\r\n            playerCol: props.playerCol,\r\n            playerColor: Color.DEFAULT,\r\n            showSolution: false,\r\n            movesTaken: 0,\r\n            gameStarted: false,\r\n            gameOver: false,\r\n            gameWon: false,\r\n            starsWon: 0,\r\n            isPlayerMoving: false,\r\n            isMenuOpen: false,\r\n            areSettingsOpened: false,\r\n            areInstructionsOpened: false,\r\n            shouldCancelTilePress: false,\r\n            shouldResetLayout: false,\r\n            showTutorial: !props.completedBefore && !!props.levelInstructions &&\r\n                props.levelInstructions.length > 0,\r\n            tileSizeIndex: DEFAULT_TILE_SIZE_INDEX\r\n        };\r\n\r\n        this.gridAnimationQueue = new Queue();\r\n        this.gameContainerRef = React.createRef();\r\n        this.gameHistory = new GameHistory(\r\n            this.state.grid,\r\n            this.state.playerRow,\r\n            this.state.playerCol,\r\n            this.state.playerColor\r\n        );\r\n\r\n        this.onKeyDown = this.onKeyDown.bind(this);\r\n        this.onKeyUp = this.onKeyUp.bind(this);\r\n        this.resetFlags = this.resetFlags.bind(this);\r\n        this.onPlayerAnimationEnd = this.onPlayerAnimationEnd.bind(this);\r\n        this.restartGame = this.restartGame.bind(this);\r\n        this.inGameRestart = this.inGameRestart.bind(this);\r\n        this.setMenuOpen = this.setMenuOpen.bind(this);\r\n        this.undo = this.undo.bind(this);\r\n        this.redo = this.redo.bind(this);\r\n        this.zoomIn = this.zoomIn.bind(this);\r\n        this.zoomOut = this.zoomOut.bind(this);\r\n        this.showSettings = this.showSettings.bind(this);\r\n        this.showInstructions = this.showInstructions.bind(this);\r\n        this.hideOtherWindows = this.hideOtherWindows.bind(this);\r\n        this.onTilePress = this.onTilePress.bind(this);\r\n        this.setShouldCancelTilePress = this.setShouldCancelTilePress.bind(this);\r\n        this.onGridSizeChange = this.onGridSizeChange.bind(this);\r\n        this.resetLayout = this.resetLayout.bind(this);\r\n        this.onCompleteTutorial = this.onCompleteTutorial.bind(this);\r\n        this.startTutorial = this.startTutorial.bind(this);\r\n\r\n        this.movementKeyFnMap = {\r\n            ArrowUp: this.movePlayerByKeyDown.bind(this, Direction.UP),\r\n            ArrowDown: this.movePlayerByKeyDown.bind(this, Direction.DOWN),\r\n            ArrowLeft: this.movePlayerByKeyDown.bind(this, Direction.LEFT),\r\n            ArrowRight: this.movePlayerByKeyDown.bind(this, Direction.RIGHT)\r\n        };\r\n\r\n        this.utilKeyFnMap = {\r\n            r: this.inGameRestart,\r\n            y: this.redo,\r\n            z: this.undo\r\n        };\r\n\r\n        this.keyPressFlagMap = {\r\n            ArrowUp: false,\r\n            ArrowDown: false,\r\n            ArrowLeft: false,\r\n            ArrowRight: false\r\n        };\r\n    }\r\n\r\n    onKeyDown(event: KeyboardEvent): void {\r\n\r\n        // Toggle menu\r\n        if (event.key === \"Escape\" || event.key === \"Esc\") {\r\n            event.preventDefault();\r\n            this.setMenuOpen(!this.state.isMenuOpen);\r\n        }\r\n\r\n        // Button press while menu is opened\r\n        else if (this.state.isMenuOpen) {\r\n            this.handleMenuKeyDown(event);\r\n        }\r\n\r\n        // Player movement\r\n        else if (this.movementKeyFnMap[event.key]) {\r\n            event.preventDefault();\r\n\r\n            if (!this.keyPressFlagMap[event.key]) {\r\n                this.keyPressFlagMap[event.key] = true;\r\n                this.movementKeyFnMap[event.key](event);\r\n            }\r\n        }\r\n\r\n        // Utility function\r\n        else if (this.utilKeyFnMap[event.key]) {\r\n            event.preventDefault();\r\n            this.utilKeyFnMap[event.key]();\r\n        }\r\n\r\n        // Toggle solution\r\n        else if (event.key.toLowerCase() === \"q\") {\r\n            event.preventDefault();\r\n            this.setState({ showSolution: true });\r\n        }\r\n    }\r\n\r\n    // Handles key presses while the game menu is opened\r\n    handleMenuKeyDown(event: KeyboardEvent): void {\r\n        const activeEle = document.activeElement;\r\n        const isActiveOnHam = !!activeEle && activeEle.classList.contains(\"hamburger-react\");\r\n        const isActiveOnLink = !!activeEle && activeEle.classList.contains(\"game-menu-btn\");\r\n        const isActiveOnFirst = !!activeEle && activeEle.classList.contains(\"game-menu-first\");\r\n        const isActiveOnLast = !!activeEle && activeEle.classList.contains(\"game-menu-last\");\r\n\r\n        // Go to next menu item\r\n        if (event.key === \"ArrowDown\") {\r\n            event.preventDefault();\r\n\r\n            if (!activeEle || isActiveOnLast || (!isActiveOnHam && !isActiveOnLink)) {\r\n                const hamBtn = document.querySelector<HTMLElement>(\".hamburger-react\");\r\n                hamBtn && hamBtn.focus();\r\n            } else if (isActiveOnHam) {\r\n                const firstBtn = document.querySelector<HTMLElement>(\".game-menu-btn\");\r\n                firstBtn && firstBtn.focus();\r\n            } else {\r\n                const sibling = activeEle.nextSibling as HTMLElement;\r\n                sibling && sibling.focus();\r\n            }\r\n\r\n        }\r\n\r\n        // Go to previous menu item\r\n        else if (event.key === \"ArrowUp\") {\r\n            event.preventDefault();\r\n\r\n            if (!activeEle || isActiveOnHam || !isActiveOnLink) {\r\n                const lastBtn = document.querySelector<HTMLElement>(\".game-menu-last\");\r\n                lastBtn && lastBtn.focus();\r\n            } else if (isActiveOnFirst) {\r\n                const hamBtn = document.querySelector<HTMLElement>(\".hamburger-react\");\r\n                hamBtn && hamBtn.focus();\r\n            } else {\r\n                const sibling = activeEle.previousSibling as HTMLElement;\r\n                sibling && sibling.focus();\r\n            }\r\n        }\r\n    }\r\n\r\n    onKeyUp(event: KeyboardEvent): void {\r\n        if (this.keyPressFlagMap[event.key]) {\r\n            event.preventDefault();\r\n            this.keyPressFlagMap[event.key] = false;\r\n        } else if (event.key.toLowerCase() === \"q\") {\r\n            event.preventDefault();\r\n            this.setState({ showSolution: false });\r\n        }\r\n    }\r\n\r\n    resetFlags(): void {\r\n        for (const key in this.keyPressFlagMap) {\r\n            this.keyPressFlagMap[key] = false;\r\n        }\r\n\r\n        this.setState({ showSolution: false });\r\n    }\r\n\r\n    // Processes a move and returns the number of tiles moved\r\n    makeMove(grid: Grid, player: Player, playerMovement: PlayerMovement): MoveCount {\r\n        let moveResult = player.move(playerMovement);\r\n        const moveCount = {\r\n            count: 0,\r\n            [Direction.UP]: 0,\r\n            [Direction.DOWN]: 0,\r\n            [Direction.LEFT]: 0,\r\n            [Direction.RIGHT]: 0\r\n        };\r\n\r\n        // If move is invalid, return\r\n        if (!moveResult.moved) {\r\n            return moveCount;\r\n        }\r\n\r\n        // Otherwise, add animation frames until the player stops moving\r\n        let isStart = true;\r\n        while (moveResult.moved) {\r\n\r\n            // Update count\r\n            const {\r\n                newRow,\r\n                newCol,\r\n                newColor,\r\n                gridCellMovedTo,\r\n                movementType,\r\n                directionMoved\r\n            } = moveResult;\r\n\r\n            moveCount.count += 1;\r\n            if (directionMoved && moveCount[directionMoved] !== undefined) {\r\n                moveCount[directionMoved] += 1;\r\n            }\r\n\r\n            // Check if the grid tile needs to be updated\r\n            let updatedTileColor = gridCellMovedTo && gridCellMovedTo.updateColor(newColor);\r\n            if (updatedTileColor) {\r\n                this.gridAnimationQueue.enqueue(\r\n                    new TileAnimationFrame(newRow, newCol, updatedTileColor)\r\n                );\r\n            }\r\n\r\n            // Add player animation frame\r\n            this.gridAnimationQueue.enqueue(\r\n                new PlayerAnimationFrame(newRow, newCol, newColor, movementType, isStart)\r\n            );\r\n\r\n            // Try to move again\r\n            playerMovement = {\r\n                currentDirection: null,\r\n                prevDirection: directionMoved || null\r\n            };\r\n\r\n            isStart = false;\r\n            moveResult = player.move(playerMovement);\r\n        }\r\n\r\n        // Record final state in game history\r\n        this.gameHistory.push(grid, player.row, player.col, player.color);\r\n\r\n        return moveCount;\r\n    }\r\n\r\n    isAnimationInProgress(): boolean {\r\n        return (this.gridAnimationQueue.size() > 0 || this.state.isPlayerMoving);\r\n    }\r\n\r\n    isGameActive(): boolean {\r\n        return !this.state.gameOver && !this.state.isMenuOpen;\r\n    }\r\n\r\n    async movePlayerByKeyDown(dir: Direction, event: KeyboardEvent): Promise<void> {\r\n\r\n        let movedPrevLoop = false; // Flag to prevent infinite loop\r\n\r\n        // Continuously move the player while key is pressed down, game is not over,\r\n        // and menu is closed\r\n        while (this.keyPressFlagMap[event.key] && this.isGameActive()) {\r\n\r\n            // Do not move the player if already in motion; wait until next cycle and check again\r\n            if (this.isAnimationInProgress() || movedPrevLoop) {\r\n                movedPrevLoop = false;\r\n                await sleep(0);\r\n                continue;\r\n            }\r\n\r\n            const { grid, playerRow, playerCol, playerColor } = this.state;\r\n            const gridClone = cloneDeep(grid);\r\n            const player = new Player(playerRow, playerCol, gridClone, playerColor);\r\n\r\n            let playerMovement: PlayerMovement = { currentDirection: dir, prevDirection: null };\r\n            let moveCount = this.makeMove(gridClone, player, playerMovement);\r\n\r\n            // If move is invalid, wait until next cycle\r\n            if (moveCount.count === 0) {\r\n                await sleep(0);\r\n                continue;\r\n            }\r\n\r\n            // Otherwise, the move was valid; process next animation\r\n            this.startNextAnimation();\r\n\r\n            // Set flag\r\n            movedPrevLoop = true;\r\n        }\r\n    }\r\n\r\n    onTilePress(row: number, col: number): void {\r\n        const { grid, playerRow, playerCol, playerColor, shouldCancelTilePress } = this.state;\r\n\r\n        // Do not move if the tile pressed is not on the same row or column; or if it is the same\r\n        // tile that the player is on already; or if there is animation in progress; or if the\r\n        // press should be cancelled (e.g. because the user was dragging to the grid)\r\n        if ((row === playerRow && col === playerCol) || (row !== playerRow && col !== playerCol) ||\r\n            this.isAnimationInProgress() || shouldCancelTilePress) {\r\n            return;\r\n        }\r\n\r\n        // Determine the movement direction\r\n        let pressDir = null;\r\n        if (row < playerRow) { pressDir = Direction.UP; }\r\n        else if (row > playerRow) { pressDir = Direction.DOWN; }\r\n        else if (col < playerCol) { pressDir = Direction.LEFT; }\r\n        else if (col > playerCol) { pressDir = Direction.RIGHT; }\r\n\r\n        // Determine maximum number of times to move in that direction\r\n        const numTimesToMove = Math.max(Math.abs(playerRow - row), Math.abs(playerCol - col));\r\n\r\n        let gridClone = cloneDeep(grid);\r\n        const player = new Player(playerRow, playerCol, gridClone, playerColor);\r\n        let timesMoved = 0;\r\n\r\n        // Start moving in that direction\r\n        while (timesMoved < numTimesToMove) {\r\n            let playerMovement: PlayerMovement = {\r\n                currentDirection: pressDir,\r\n                prevDirection: null\r\n            };\r\n            let moveCount = this.makeMove(gridClone, player, playerMovement);\r\n\r\n            // Do not continue unless the player moved exclusively in the movement direction\r\n            if (moveCount.count === 0) {\r\n                break;\r\n            }\r\n\r\n            let shouldStopMoving = false;\r\n            for (const dir of [ Direction.UP, Direction.DOWN, Direction.LEFT, Direction.RIGHT ]) {\r\n                if (dir !== pressDir && moveCount[dir] > 0) {\r\n                    shouldStopMoving = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (shouldStopMoving) {\r\n                break;\r\n            }\r\n\r\n            // Increment move counter\r\n            if (pressDir && moveCount[pressDir]) {\r\n                timesMoved += moveCount[pressDir];\r\n            }\r\n\r\n            // Re-clone the grid for each move\r\n            gridClone = cloneDeep(gridClone);\r\n            player.grid = gridClone;\r\n        }\r\n\r\n        // Process next animation\r\n        this.startNextAnimation();\r\n    }\r\n\r\n    onGridSizeChange(width?: number, height?: number): void {\r\n        this.setState({\r\n            gridWidth: width,\r\n            gridHeight: height\r\n        });\r\n    }\r\n\r\n    startNextAnimation(): void {\r\n\r\n        // Process animations until we process a player animation\r\n        while (this.gridAnimationQueue.size() > 0) {\r\n            const animationFrame = this.gridAnimationQueue.dequeue();\r\n\r\n            // Process player animation\r\n            if (animationFrame.isPlayerAnimation()) {\r\n                // Move the player\r\n                this.setState({\r\n                    playerRow: animationFrame.row,\r\n                    playerCol: animationFrame.col,\r\n                    playerColor: animationFrame.color,\r\n                    isPlayerMoving: true,\r\n                    gameStarted: true,\r\n                    movesTaken: this.state.movesTaken + (animationFrame.isStart ? 1 : 0),\r\n                    playerMovementType: animationFrame.movementType\r\n                });\r\n\r\n                break;\r\n            }\r\n\r\n            // Process tile animation\r\n            else {\r\n                this.setState({\r\n                    grid: produce(this.state.grid, draft => {\r\n                        const gridCell = draft.getCellAt(animationFrame.row, animationFrame.col);\r\n                        gridCell && (gridCell.color = animationFrame.color);\r\n                    })\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    // This method is called after player animation is completed\r\n    onPlayerAnimationEnd(): void {\r\n        this.setState({ isPlayerMoving: false });\r\n\r\n        if (this.gridAnimationQueue.size() > 0) {\r\n            this.startNextAnimation();\r\n        } else if (this.state.grid.isGridSolved()) {\r\n            this.setState({\r\n                gameOver: true,\r\n                gameWon: true,\r\n                showTutorial: false,\r\n                starsWon: this.props.handleStarUpdate(this.props.levelNumber, this.state.movesTaken)\r\n            });\r\n        }\r\n    }\r\n\r\n    restartGame(): void {\r\n        const newGrid = new Grid(this.props.gridConfig);\r\n\r\n        this.setState({\r\n            grid: newGrid,\r\n            playerRow: this.props.playerRow,\r\n            playerCol: this.props.playerCol,\r\n            playerColor: Color.DEFAULT,\r\n            movesTaken: 0,\r\n            gameStarted: false,\r\n            gameOver: false,\r\n            gameWon: false,\r\n            starsWon: 0,\r\n            isPlayerMoving: false,\r\n            showSolution: false,\r\n            isMenuOpen: false,\r\n            shouldCancelTilePress: false,\r\n            shouldResetLayout: false\r\n        });\r\n\r\n        this.gameHistory = new GameHistory(\r\n            newGrid,\r\n            this.props.playerRow,\r\n            this.props.playerCol,\r\n            Color.DEFAULT\r\n        );\r\n\r\n        this.gridAnimationQueue.clear();\r\n\r\n        // Re-focus on the game container\r\n        this.gameContainerRef.current && this.gameContainerRef.current.focus();\r\n    }\r\n\r\n    // Only restart in the middle of a game if certain conditions are met\r\n    inGameRestart(): void {\r\n        if (!this.canAlterGameState()) {\r\n            return;\r\n        }\r\n\r\n        this.restartGame();\r\n    }\r\n\r\n    canAlterGameState() {\r\n        return (!this.state.isPlayerMoving && this.gridAnimationQueue.size() <= 0 &&\r\n            this.isGameActive());\r\n    }\r\n\r\n    undo(): void {\r\n        if (!this.canAlterGameState()) {\r\n            return;\r\n        }\r\n\r\n        const gameHistoryState = this.gameHistory.undo();\r\n\r\n        if (gameHistoryState) {\r\n            this.setState({\r\n                grid: gameHistoryState.grid,\r\n                playerRow: gameHistoryState.playerRow,\r\n                playerCol: gameHistoryState.playerCol,\r\n                playerColor: gameHistoryState.playerColor,\r\n                movesTaken: this.state.movesTaken - 1\r\n            });\r\n        }\r\n    }\r\n\r\n    redo(): void {\r\n        if (!this.canAlterGameState()) {\r\n            return;\r\n        }\r\n\r\n        const gameHistoryState = this.gameHistory.redo();\r\n\r\n        if (gameHistoryState) {\r\n            this.setState({\r\n                grid: gameHistoryState.grid,\r\n                playerRow: gameHistoryState.playerRow,\r\n                playerCol: gameHistoryState.playerCol,\r\n                playerColor: gameHistoryState.playerColor,\r\n                movesTaken: this.state.movesTaken + 1\r\n            });\r\n        }\r\n    }\r\n\r\n    canZoomIn(): boolean {\r\n        return this.state.tileSizeIndex < TILES_SIZES.length - 1;\r\n    }\r\n\r\n    canZoomOut(): boolean {\r\n        return this.state.tileSizeIndex > 0;\r\n    }\r\n\r\n    zoomIn(): void {\r\n        if (this.canZoomIn() && this.isGameActive()) {\r\n            this.setState({\r\n                tileSizeIndex: this.state.tileSizeIndex + 1\r\n            });\r\n        }\r\n    }\r\n\r\n    zoomOut(): void {\r\n        if (this.canZoomOut() && this.isGameActive()) {\r\n            this.setState({\r\n                tileSizeIndex: this.state.tileSizeIndex - 1\r\n            });\r\n        }\r\n    }\r\n\r\n    setMenuOpen(isOpen: boolean): void {\r\n        this.setState({\r\n            isMenuOpen: isOpen\r\n        });\r\n\r\n        this.resetFlags();\r\n\r\n        // If closing the menu, refocus on the game container\r\n        if (!isOpen) {\r\n            this.gameContainerRef.current && this.gameContainerRef.current.focus();\r\n        }\r\n    }\r\n\r\n    showSettings(): void {\r\n        this.setState({\r\n            areSettingsOpened: true,\r\n            areInstructionsOpened: false\r\n        });\r\n    }\r\n\r\n    showInstructions(): void {\r\n        this.setState({\r\n            areSettingsOpened: false,\r\n            areInstructionsOpened: true\r\n        });\r\n    }\r\n\r\n    resetLayout(): void {\r\n        // Set the flag\r\n        this.setState({\r\n            shouldResetLayout: true,\r\n            tileSizeIndex: DEFAULT_TILE_SIZE_INDEX\r\n        }, async () => {\r\n            // Wait one cycle\r\n            await sleep(0);\r\n\r\n            // Unset the flag\r\n            this.setState({ shouldResetLayout: false });\r\n        });\r\n    }\r\n\r\n    hideOtherWindows(): void {\r\n        this.setState({\r\n            areSettingsOpened: false,\r\n            areInstructionsOpened: false,\r\n            isMenuOpen: false\r\n        });\r\n    }\r\n\r\n    onCompleteTutorial(): void {\r\n        this.setState({\r\n            showTutorial: false\r\n        });\r\n    }\r\n\r\n    startTutorial(): void {\r\n        this.setState({\r\n            showTutorial: true\r\n        });\r\n    }\r\n\r\n    // Focus on the game container after mounting\r\n    componentDidMount(): void {\r\n        this.gameContainerRef.current && this.gameContainerRef.current.focus();\r\n    }\r\n\r\n    componentDidUpdate(prevProps: GameProps): void {\r\n        if (this.props.levelNumber !== prevProps.levelNumber) {\r\n            this.restartGame();\r\n            this.setState({\r\n                tileSizeIndex: DEFAULT_TILE_SIZE_INDEX,\r\n                showTutorial: !this.props.completedBefore && !!this.props.levelInstructions &&\r\n                    this.props.levelInstructions.length > 0,\r\n            });\r\n        }\r\n    }\r\n\r\n    setShouldCancelTilePress(bool: boolean): void {\r\n        this.setState({\r\n            shouldCancelTilePress: bool\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            grid,\r\n            playerRow,\r\n            playerCol,\r\n            playerColor,\r\n            playerMovementType,\r\n            showSolution,\r\n            isPlayerMoving,\r\n            movesTaken,\r\n            gameStarted,\r\n            gameWon,\r\n            gameOver,\r\n            isMenuOpen,\r\n            areSettingsOpened,\r\n            areInstructionsOpened,\r\n            gridWidth,\r\n            gridHeight,\r\n            shouldResetLayout\r\n        } = this.state;\r\n\r\n        let gameClass = \"game\";\r\n        gameClass += gameWon ? \" game-won\" : \"\";\r\n        gameClass += !gameStarted ? \" game-pending\" : \"\";\r\n\r\n        const gameStyle = (areSettingsOpened || areInstructionsOpened) ? { display: \"none\" } : {};\r\n\r\n        // Only show the completion component when the user beats the puzzle\r\n        const gameCompleteEle = gameWon ? (\r\n            <GameComplete levelNumber={this.props.levelNumber}\r\n                stars={this.state.starsWon}\r\n                restartHandler={this.restartGame}\r\n                starsScoredOnLevel={this.props.starsScoredOnLevel}\r\n                starsToUnlockLevel={this.props.starsToUnlockLevel} />\r\n        ) : null;\r\n\r\n        const tileSize = TILES_SIZES[this.state.tileSizeIndex] ?? DEFAULT_TILE_SIZE\r\n        const canStartTutorial = !!this.props.levelInstructions &&\r\n            this.props.levelInstructions.length > 0 &&\r\n            !this.state.showTutorial;\r\n        const startTutorial = canStartTutorial ? this.startTutorial : undefined;\r\n\r\n        // Game tutorial\r\n        const tutorial = (this.props.levelInstructions && this.state.showTutorial) ? (\r\n            <GameTutorial levelInstructions={this.props.levelInstructions}\r\n                onComplete={this.onCompleteTutorial} isMenuOpen={isMenuOpen} />\r\n        ) : null;\r\n\r\n        return (\r\n            <div>\r\n                <TileSizeContext.Provider value={tileSize}>\r\n                    <div className={gameClass}\r\n                        ref={this.gameContainerRef}\r\n                        tabIndex={1}\r\n                        onKeyDown={this.onKeyDown}\r\n                        onKeyUp={this.onKeyUp}\r\n                        onFocus={this.resetFlags}\r\n                        onBlur={this.resetFlags}\r\n                        style={gameStyle}>\r\n\r\n                        <GameHUD\r\n                            movesTaken={movesTaken}\r\n                            levelNumber={this.props.levelNumber}\r\n                            levelName={this.props.levelName}\r\n                            isMenuOpen={isMenuOpen}\r\n                            setMenuOpen={this.setMenuOpen}\r\n                            showSettings={this.showSettings}\r\n                            showInstructions={this.showInstructions}\r\n                            resetLayout={this.resetLayout}\r\n                            startTutorial={startTutorial} />\r\n                        <Solution\r\n                            grid={grid}\r\n                            playerRow={playerRow}\r\n                            playerCol={playerCol}\r\n                            levelNumber={this.props.levelNumber}\r\n                            gridWidth={gridWidth}\r\n                            gridHeight={gridHeight}\r\n                            appHeight={this.props.appHeight}\r\n                            shouldResetLayout={shouldResetLayout}\r\n                            gameOver={gameOver}\r\n                            isMenuOpen={isMenuOpen} />\r\n                        <GameAdjustMenu\r\n                            canUndo={this.gameHistory.canUndo()}\r\n                            canRedo={this.gameHistory.canRedo()}\r\n                            canZoomIn={this.canZoomIn()}\r\n                            canZoomOut={this.canZoomOut()}\r\n                            restartHandler={this.inGameRestart}\r\n                            undoHandler={this.undo}\r\n                            redoHandler={this.redo}\r\n                            zoomInHandler={this.zoomIn}\r\n                            zoomOutHandler={this.zoomOut} />\r\n                        <GridComponent\r\n                            grid={grid}\r\n                            playerRow={playerRow}\r\n                            playerCol={playerCol}\r\n                            playerColor={playerColor}\r\n                            levelNumber={this.props.levelNumber}\r\n                            showSolution={showSolution}\r\n                            isPlayerMoving={isPlayerMoving}\r\n                            playerMovementType={playerMovementType}\r\n                            onPlayerAnimationEnd={this.onPlayerAnimationEnd}\r\n                            onTilePress={this.onTilePress}\r\n                            dragHandler={this.setShouldCancelTilePress}\r\n                            onGridSizeChange={this.onGridSizeChange}\r\n                            shouldResetLayout={shouldResetLayout} />\r\n\r\n                        {gameCompleteEle}\r\n                        {tutorial}\r\n                    </div>\r\n                </TileSizeContext.Provider>\r\n\r\n                <Settings\r\n                    visible={areSettingsOpened}\r\n                    onGoBack={this.hideOtherWindows} />\r\n\r\n                <Instructions\r\n                    visible={areInstructionsOpened}\r\n                    onGoBack={this.hideOtherWindows} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import { Redirect, useParams } from \"react-router\";\r\nimport Game from \"../game\";\r\nimport LEVELS from \"../../services/levels\";\r\n\r\nimport type { LevelScore } from \"../../services/definitions\";\r\n\r\ninterface GameParams {\r\n    levelNumber: string\r\n};\r\n\r\ninterface GameRedirectProps {\r\n    starCount: number,\r\n    levelScoreMap: Record<string, LevelScore>,\r\n    handleStarUpdate: (levelNumber: number, movesTaken: number) => number,\r\n    starsScoredOnLevel: (levelNum: number) => number,\r\n    starsToUnlockLevel: (levelNum: number) => number,\r\n    appHeight?: number\r\n};\r\n\r\nexport default function GameRedirect(props: GameRedirectProps) {\r\n    const { levelNumber } = useParams<GameParams>();\r\n    const levelInt = parseInt(levelNumber);\r\n\r\n    if (isNaN(levelInt) || !LEVELS[levelInt - 1] ||\r\n        props.starCount < LEVELS[levelInt - 1].requiredToUnlock) {\r\n        return <Redirect to=\"/level-select\" />\r\n    }\r\n\r\n    const {\r\n        id,\r\n        gridConfig,\r\n        playerRow,\r\n        playerCol,\r\n        levelName,\r\n        levelInstructions\r\n    } = LEVELS[levelInt - 1];\r\n\r\n    return (\r\n        <Game gridConfig={gridConfig} playerRow={playerRow} playerCol={playerCol}\r\n            levelName={levelName} levelNumber={levelInt}\r\n            handleStarUpdate={props.handleStarUpdate}\r\n            starsScoredOnLevel={props.starsScoredOnLevel}\r\n            starsToUnlockLevel={props.starsToUnlockLevel}\r\n            appHeight={props.appHeight}\r\n            levelInstructions={levelInstructions}\r\n            completedBefore={!!props.levelScoreMap[id] && props.levelScoreMap[id].solved} />\r\n    );\r\n}\r\n","import { useState } from \"react\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport Settings from \"../settings\";\r\nimport Instructions from \"../instructions\";\r\nimport LEVELS from \"../../services/levels\";\r\nimport \"./home.scss\";\r\n\r\ninterface HomeProps {\r\n    playAnimation: boolean,\r\n    starsScoredOnLevel: (levelNum: number) => number\r\n    onEraseData: () => void\r\n};\r\n\r\nconst TITLE = (\r\n    <>\r\n        <span className=\"first-letter\">C</span>OLOR&nbsp;\r\n        <span className=\"first-letter\">C</span>OORDS\r\n    </>\r\n);\r\n\r\nconst TITLE_COL_NUM = 6;\r\nconst BG_LAYER_NUM = 48;\r\nconst GRADIENT_ANIM_TIME = 300;\r\n\r\nexport default function Home(props: HomeProps) {\r\n    const [ gradientDelay ] = useState(Math.random() * GRADIENT_ANIM_TIME);\r\n    const [ playAnimation, setPlayAnimation ] = useState(props.playAnimation);\r\n    const [ showSettings, setShowSettings ] = useState(false);\r\n    const [ showInstructions, setShowInstructions ] = useState(false);\r\n    const [ playLevelNumber, setPlayLevelNumber ] = useState<number | null>(null);\r\n\r\n    const onPlay = () => {\r\n        let lastUnlockedLevel = 1;\r\n        let firstUnsolvedLevel: (number | null) = null;\r\n        let firstIncompleteLevel: (number | null) = null;\r\n\r\n        for (let i = 0; i < LEVELS.length; i += 1) {\r\n            const levelNum = i + 1;\r\n            const starsScored = props.starsScoredOnLevel(levelNum);\r\n\r\n            if (starsScored === 0) {\r\n                firstUnsolvedLevel = i + 1;\r\n                break;\r\n            }\r\n\r\n            if (starsScored > 0) {\r\n                lastUnlockedLevel = i + 1;\r\n\r\n                if (firstIncompleteLevel === null && starsScored < 3) {\r\n                    firstIncompleteLevel = i + 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (firstUnsolvedLevel !== null) {\r\n            setPlayLevelNumber(firstUnsolvedLevel);\r\n        } else if (firstIncompleteLevel !== null) {\r\n            setPlayLevelNumber(firstIncompleteLevel);\r\n        } else {\r\n            setPlayLevelNumber(lastUnlockedLevel);\r\n        }\r\n    };\r\n\r\n    const onReturn = () => {\r\n        setShowSettings(false);\r\n        setShowInstructions(false);\r\n        setPlayAnimation(false);\r\n    };\r\n\r\n    const onSettingsClick = () => {\r\n        setShowSettings(true);\r\n        setShowInstructions(false);\r\n    };\r\n\r\n    const onInstructionsClick = () => {\r\n        setShowSettings(false);\r\n        setShowInstructions(true);\r\n    };\r\n\r\n    const homeClass = `home-container ${!playAnimation ? \" home-anim-off\" : \"\"}`;\r\n    const coloredTitles = [];\r\n    const bgLayers = [];\r\n\r\n    for (let i = 0; i < TITLE_COL_NUM; i += 1) {\r\n        const key = `title-colored-${i + 1}`;\r\n        const titleClass = `title-box title-colored ${key}`;\r\n        coloredTitles.push(\r\n            <div className={titleClass} key={key}>\r\n                <span className=\"title-text\" aria-hidden>{TITLE}</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    for (let i = 0; i < 4; i += 1) {\r\n        for (let j = 0; j < BG_LAYER_NUM; j += 1) {\r\n            const key = `bg-layer-${i + 1}-${j + 1}`;\r\n            const layerClass = `bg-layer bg-layer-${j + 1}`\r\n            bgLayers.push(\r\n                <div className={layerClass} key={key}></div>\r\n            );\r\n        }\r\n    }\r\n\r\n    const gradientStyle = {\r\n        animationDelay: `-${gradientDelay}s`\r\n    };\r\n\r\n    const homeStyle = {\r\n        display: (showSettings || showInstructions) ? \"none\" : \"block\"\r\n    };\r\n\r\n    if (playLevelNumber !== null) {\r\n        return <Redirect to={`/game/${playLevelNumber}`} />\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className={homeClass} style={homeStyle}>\r\n                <div className=\"home-bg\">\r\n                    <div className=\"home-bg-gradient\" style={gradientStyle}>{bgLayers}</div>\r\n                </div>\r\n                <div className=\"title-container\">\r\n                    <div className=\"title-box title-main\">\r\n                        <h1 className=\"title-text\" aria-label=\"Color Coords\">{TITLE}</h1>\r\n                    </div>\r\n                    {coloredTitles}\r\n                </div>\r\n\r\n                <nav className=\"home-nav\">\r\n                    <button className=\"home-nav-btn-1\" onClick={onPlay}>Play</button><br />\r\n\r\n                    <Link to=\"/level-select\" className=\"home-nav-btn-2\">Level Select</Link><br />\r\n\r\n                    <button className=\"home-nav-btn-3\" onClick={onInstructionsClick}>\r\n                        How to Play\r\n                    </button><br />\r\n\r\n                    <button className=\"home-nav-btn-4\" onClick={onSettingsClick}>Settings</button>\r\n                </nav>\r\n            </div>\r\n\r\n            <Settings\r\n                visible={showSettings}\r\n                onGoBack={onReturn}\r\n                onEraseData={props.onEraseData} />\r\n\r\n            <Instructions\r\n                visible={showInstructions}\r\n                onGoBack={onReturn} />\r\n        </div>\r\n    );\r\n}\r\n","import LEVELS from \"./levels\";\r\nimport type { LevelScore } from \"./definitions\";\r\n\r\n// Creates a simple mapping between level ID and level score\r\n// Assumes player has not completed any level\r\nexport function getDefaultLevelScoreMap() {\r\n    // Create mapping\r\n    const levelScoreMap: Record<string, LevelScore> = {};\r\n\r\n    // Default mapping - no saved scores\r\n    for (const levelConfig of LEVELS) {\r\n        levelScoreMap[levelConfig.id] = {\r\n            solved: false,\r\n            moves: 0,\r\n            stars: 0\r\n        };\r\n    }\r\n\r\n    return levelScoreMap;\r\n}\r\n\r\n/**\r\n * Calculates the number of stars, given the number of moves taken and the star requirements\r\n * @param moves\r\n * @param starReq3\r\n * @param starReq2\r\n * @returns\r\n */\r\nexport function getStarsScoredByMoves(moves: number, starReq3: number, starReq2: number): number {\r\n    let starsScored = 1;\r\n    if (moves <= starReq3) {\r\n        starsScored = 3;\r\n    } else if (moves <= starReq2) {\r\n        starsScored = 2;\r\n    }\r\n\r\n    return starsScored;\r\n}\r\n","import { openDB } from \"idb\";\r\nimport { getStarsScoredByMoves, getDefaultLevelScoreMap } from \"./cc-util\";\r\nimport LEVELS from \"./levels\";\r\n\r\nimport type { IDBPDatabase } from \"idb\";\r\nimport type { LevelScore } from \"./definitions\";\r\nimport type { GameConfig } from \"./levels\";\r\n\r\nconst DB_NAME = \"cc\";\r\nconst SCORES_STORE_NAME = \"scores\";\r\n\r\nfunction upgrade(db: IDBPDatabase) {\r\n    db.createObjectStore(SCORES_STORE_NAME, { keyPath: \"id\" });\r\n}\r\n\r\nexport async function loadLevelScores(): Promise<Record<string, LevelScore>> {\r\n    const db = await openDB(DB_NAME, 1, { upgrade });\r\n    const transaction = db.transaction(SCORES_STORE_NAME, \"readonly\");\r\n    const scoresStore = transaction.objectStore(SCORES_STORE_NAME);\r\n\r\n    const scores = await scoresStore.getAll();\r\n    await transaction.done;\r\n\r\n    db.close();\r\n\r\n    // Create mapping\r\n    const levelScoreMap: Record<string, LevelScore> = getDefaultLevelScoreMap();\r\n    const levelById: Record<string, GameConfig> = {};\r\n\r\n    for (const levelConfig of LEVELS) {\r\n        levelById[levelConfig.id] = levelConfig;\r\n    }\r\n\r\n    // Update mapping with scores saved in DB\r\n    for (const score of scores) {\r\n        if (!isNaN(score?.moves) && levelScoreMap[score?.id]) {\r\n            levelScoreMap[score.id].solved = true;\r\n            levelScoreMap[score.id].moves = parseInt(score.moves, 10);\r\n            levelScoreMap[score.id].stars = getStarsScoredByMoves(levelScoreMap[score.id].moves,\r\n                levelById[score.id].starRequirement3, levelById[score.id].starRequirement2);\r\n        }\r\n    }\r\n\r\n    return levelScoreMap;\r\n}\r\n\r\nexport async function saveScore(levelId: string, moves: number): Promise<void> {\r\n    const db = await openDB(DB_NAME, 1, { upgrade });\r\n    const transaction = db.transaction(SCORES_STORE_NAME, \"readwrite\");\r\n    const scoresStore = transaction.objectStore(SCORES_STORE_NAME);\r\n\r\n    // Update score if fewer moves were used\r\n    const prevScore = await scoresStore.get(levelId);\r\n    if (!prevScore || isNaN(prevScore?.moves) || moves < prevScore.moves) {\r\n        await scoresStore.put({ id: levelId, moves });\r\n    }\r\n\r\n    await transaction.done;\r\n\r\n    db.close();\r\n}\r\n\r\nexport async function clearScores(): Promise<void> {\r\n    const db = await openDB(DB_NAME, 1, { upgrade });\r\n    const transaction = db.transaction(SCORES_STORE_NAME, \"readwrite\");\r\n    const scoresStore = transaction.objectStore(SCORES_STORE_NAME);\r\n\r\n    await scoresStore.clear();\r\n    await transaction.done;\r\n\r\n    db.close();\r\n}\r\n","import { useState, useEffect } from \"react\";\nimport { useResizeDetector } from 'react-resize-detector/build/withPolyfill';\nimport produce from \"immer\";\nimport WebFont from \"webfontloader\";\nimport { HashRouter as Router, Route, Switch } from \"react-router-dom\";\nimport { ToastContainer, toast } from 'react-toastify';\nimport LevelSelect from \"../level-select\";\nimport GameRedirect from \"../game-redirect\";\nimport Home from \"../home\";\nimport { sleep } from \"../../services/util\";\nimport LEVELS from \"../../services/levels\";\nimport { loadLevelScores, saveScore, clearScores } from \"../../services/idb\";\nimport { getStarsScoredByMoves, getDefaultLevelScoreMap } from \"../../services/cc-util\";\n\nimport \"./app.scss\";\nimport 'react-toastify/dist/ReactToastify.css';\n\nimport type { LevelScore } from \"../../services/definitions\";\n\nexport default function App() {\n    const [ starCount, setStarCount ] = useState(0);\n    const [ playHomeAnimation, setPlayHomeAnimation ] = useState(true);\n    const [ isReady, setIsReady ] = useState(false);\n    const [ areFontsLoaded, setAreFontsLoaded ] = useState(false);\n    const [ isSavedDataLoaded, setIsSavedDataLoaded ] = useState(false);\n    const [ levelScoreMap, setLevelScoreMap ] = useState<Record<string, LevelScore>>({});\n\n    const { height, ref } = useResizeDetector({\n        refreshMode: \"throttle\",\n        refreshRate: 1\n    });\n\n    /**\n     * Handler to update star counts after a level is completed\n     * @param levelNumber - Level identifier (1-indexed)\n     * @param movesTaken - Moves taken to complete the level\n     * @returns Number of stars awarded for the given level attempt\n     */\n    const handleStarUpdate = (levelNumber: number, movesTaken: number) => {\n        const levelConfig = LEVELS[levelNumber - 1];\n        if (!levelConfig) { return 0; }\n\n        // Get the star score for the current level attempt\n        let starsScored = getStarsScoredByMoves(movesTaken, levelConfig.starRequirement3,\n            levelConfig.starRequirement2);\n\n        if (movesTaken < levelScoreMap[levelConfig.id]?.moves ||\n            levelScoreMap[levelConfig.id]?.solved === false) {\n\n            const prevStars = levelScoreMap[levelConfig.id]?.stars ?? 0;\n            const nextLevelScoreMap = produce(levelScoreMap, draft => {\n                draft[levelConfig.id].solved = true;\n                draft[levelConfig.id].moves = movesTaken;\n                draft[levelConfig.id].stars = starsScored;\n            });\n\n            setLevelScoreMap(nextLevelScoreMap);\n            setStarCount(starCount + (starsScored - prevStars));\n        }\n\n        // Update DB\n        saveScore(levelConfig.id, movesTaken)\n            .catch(() => {\n                toast.error(\"Unable to save data.\");\n            });\n\n        return starsScored;\n    };\n\n    /**\n     * Returns the number stars the player has collected from the given level\n     * @param levelNum 1-indexed\n     * @returns If the level is unlocked, return the number of stars scored on the level; returns\n     *          -1 if the level is locked\n     */\n    const starsScoredOnLevel = (levelNum: number) => {\n        const level = LEVELS[levelNum - 1];\n        if (!level) { return -1; }\n\n        if (levelScoreMap[level.id]?.stars > 0 || starCount >= level.requiredToUnlock) {\n            return (levelScoreMap[level.id]?.stars ?? 0);\n        }\n\n        return -1;\n    };\n\n    /**\n     * Returns the number of additional stars the player must collect in order to unlock the given\n     * level\n     * @param levelNum 1-indexed\n     * @returns If the level is unlocked, returns 0; if given level is invalid, returns -1;\n     *          otherwise returns the difference between the stars required and the current\n     *          number of collected stars\n     */\n    const starsToUnlockLevel = (levelNum: number) => {\n        if (starsScoredOnLevel(levelNum) >= 0) {\n            return 0;\n        }\n\n        const level = LEVELS[levelNum - 1];\n        if (!level) { return -1; }\n\n        return level.requiredToUnlock - starCount;\n    };\n\n    const eraseData = () => {\n        const nextLevelScoreMap = produce(levelScoreMap, draft => {\n            for (const levelId in draft) {\n                draft[levelId].solved = false;\n                draft[levelId].moves = 0;\n                draft[levelId].stars = 0;\n            }\n        });\n\n        setLevelScoreMap(nextLevelScoreMap);\n        setStarCount(0);\n\n        // Update DB\n        clearScores()\n            .then(() => {\n                toast.success(\"Save data has been erased.\");\n            })\n            .catch(() => {\n                toast.error(\"Unable to erase data.\");\n            });\n    };\n\n    // On mount\n    useEffect(() => {\n        // Update the loader bar\n        const loaderBarFill = getLoaderBarFill();\n        loaderBarFill && loaderBarFill.classList.add(\"loader-bar-fill-state-1\");\n\n        // Load all fonts\n        const onFontsLoad = () => {\n            setAreFontsLoaded(true);\n        };\n\n        WebFont.load({\n            custom: {\n                families: [ \"FredokaOne\", \"Nunito:n4,n6,n7,n8\", \"NunitoSans:n4,n6,n7,i4,i7\" ]\n            },\n            timeout: 5000,\n            active: onFontsLoad,\n            inactive: onFontsLoad\n        });\n\n        // Load saved data\n        loadLevelScores()\n            .then((mapping) => {\n                setLevelScoreMap(mapping);\n\n                // Calculate total stars\n                let totalStars = 0;\n                for (const key in mapping) {\n                    totalStars += mapping[key].stars;\n                }\n\n                setStarCount(totalStars);\n                setIsSavedDataLoaded(true);\n            })\n            .catch(() => {\n                setLevelScoreMap(getDefaultLevelScoreMap());\n                setIsSavedDataLoaded(true);\n                toast.error(\"Could not retrieve saved data. Please refresh and try again.\");\n            });\n\n    }, []);\n\n    // Runs after each loading stage is completed\n    useEffect(() => {\n        // Update loading bar width\n        const numFinished = 1 + (areFontsLoaded ? 1 : 0) + (isSavedDataLoaded ? 1 : 0);\n        const loaderBarFill = getLoaderBarFill();\n        loaderBarFill && loaderBarFill.classList.add(`loader-bar-fill-state-${numFinished}`);\n\n        const onFinish = async () => {\n            await sleep(500); // Slight delay\n\n            // Update loading text\n            const loadingTextElement = document.getElementById(\"loading-text\");\n            loadingTextElement && (loadingTextElement.textContent = \"Let's go!\");\n            loadingTextElement && (loadingTextElement.classList.remove(\"loading-text-anim-on\"));\n\n            // Fade out loading bar\n            const loaderElement = document.getElementById(\"loading-anim-window\");\n            loaderElement && loaderElement.classList.add(\"loading-finished\");\n\n            // Wait for fade out to finish then remove the loader; app is now ready\n            await sleep(2000);\n            loaderElement && loaderElement.remove();\n            setIsReady(true);\n\n            // Toggle off the home animation after the next cycle; this prevents the full home\n            // screen animation from playing each time the user visits the home page; the full\n            // animation will only play if it is the first page the user visits\n            await sleep(0);\n            setPlayHomeAnimation(false);\n        }\n\n        if (areFontsLoaded && isSavedDataLoaded && !isReady) {\n            onFinish();\n        }\n    }, [ areFontsLoaded, isSavedDataLoaded ]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    // Do not render anything until everything is loaded\n    if (!isReady) {\n        return null;\n    }\n\n    return (\n        // TODO: Uncomment and replace other app\n        // <div className=\"app\" onContextMenu={event => event.preventDefault()}>\n        <div className=\"app\" ref={ref}>\n            <ToastContainer />\n            <Router>\n                <Switch>\n                    <Route path=\"/game/:levelNumber\">\n                        <GameRedirect starCount={starCount} handleStarUpdate={handleStarUpdate}\n                            starsScoredOnLevel={starsScoredOnLevel}\n                            starsToUnlockLevel={starsToUnlockLevel}\n                            appHeight={height}\n                            levelScoreMap={levelScoreMap} />\n                    </Route>\n                    <Route path=\"/level-select\">\n                        <LevelSelect starCount={starCount} levelScoreMap={levelScoreMap}\n                            starsScoredOnLevel={starsScoredOnLevel}\n                            starsToUnlockLevel={starsToUnlockLevel} />\n                    </Route>\n                    <Route path=\"*\">\n                        <Home playAnimation={playHomeAnimation} onEraseData={eraseData}\n                            starsScoredOnLevel={starsScoredOnLevel}  />\n                    </Route>\n                </Switch>\n            </Router>\n        </div>\n    );\n}\n\nfunction getLoaderBarFill(): (HTMLElement | null) {\n    return document.getElementById(\"loader-bar-fill\");\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/app\";\nimport \"./index.scss\";\nimport \"../node_modules/react-resizable/css/styles.css\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}